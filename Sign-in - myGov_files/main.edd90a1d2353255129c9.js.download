!function(n){function t(t){for(var r,i,u=t[0],c=t[1],l=t[2],f=0,d=[];f<u.length;f++)i=u[f],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&d.push(o[i][0]),o[i]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(n[r]=c[r]);for(s&&s(t);d.length;)d.shift()();return a.push.apply(a,l||[]),e()}function e(){for(var n,t=0;t<a.length;t++){for(var e=a[t],r=!0,u=1;u<e.length;u++){var c=e[u];0!==o[c]&&(r=!1)}r&&(a.splice(t--,1),n=i(i.s=e[0]))}return n}var r={},o={0:0},a=[];function i(t){if(r[t])return r[t].exports;var e=r[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,i),e.l=!0,e.exports}i.m=n,i.c=r,i.d=function(n,t,e){i.o(n,t)||Object.defineProperty(n,t,{enumerable:!0,get:e})},i.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},i.t=function(n,t){if(1&t&&(n=i(n)),8&t)return n;if(4&t&&"object"==typeof n&&n&&n.__esModule)return n;var e=Object.create(null);if(i.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:n}),2&t&&"string"!=typeof n)for(var r in n)i.d(e,r,function(t){return n[t]}.bind(null,r));return e},i.n=function(n){var t=n&&n.__esModule?function(){return n.default}:function(){return n};return i.d(t,"a",t),t},i.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},i.p="";var u=window.webpackJsonp=window.webpackJsonp||[],c=u.push.bind(u);u.push=t,u=u.slice();for(var l=0;l<u.length;l++)t(u[l]);var s=c;a.push([2456,1]),e()}({1081:function(n,t){},1083:function(n,t){},1084:function(n,t){},1085:function(n,t){},1086:function(n,t){},1087:function(n,t){},1088:function(n,t){},1089:function(n,t){},1517:function(n,t){},1519:function(n,t){},1531:function(n,t){},1533:function(n,t){},1561:function(n,t){},1562:function(n,t){},1567:function(n,t){},215:function(n,t){},2205:function(n,t){},2322:function(n,t){},2343:function(n,t){},2345:function(n,t){},2348:function(n,t){},2349:function(n,t){},2350:function(n,t){},2351:function(n,t){},2352:function(n,t){},2356:function(n,t){},2456:function(n,t,e){"use strict";e.r(t);e(1099),e(1120);var r=e(253),o=e.n(r),a=e(645),i={injectType:"singletonStyleTag",insert:"head",singleton:!0},u=(o()(a.a,i),a.a.locals,e(646)),c={injectType:"singletonStyleTag",insert:"head",singleton:!0},l=(o()(u.a,c),u.a.locals,e(647)),s={injectType:"singletonStyleTag",insert:"head",singleton:!0},f=(o()(l.a,s),l.a.locals,e(0)),d=e.n(f),A=e(205),b=e.n(A),p=e(54);function m(n,t){return function(n){if(Array.isArray(n))return n}(n)||function(n,t){var e=null==n?null:"undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null==e)return;var r,o,a=[],i=!0,u=!1;try{for(e=e.call(n);!(i=(r=e.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(n){u=!0,o=n}finally{try{i||null==e.return||e.return()}finally{if(u)throw o}}return a}(n,t)||function(n,t){if(!n)return;if("string"==typeof n)return y(n,t);var e=Object.prototype.toString.call(n).slice(8,-1);"Object"===e&&n.constructor&&(e=n.constructor.name);if("Map"===e||"Set"===e)return Array.from(n);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return y(n,t)}(n,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=n[e];return r}var v=p.hooks.useStyleOptions,h=function(n){var t=n.fill,e=n.nubSize,r=n.stroke,o=n.strokeWidth,a=o/2,i=[e,a].join(" "),u=[o,a].join(" "),c=[e+o,e+a].join(" ");return d.a.createElement("svg",{className:"webchat__bubble__nub",fill:t,ref:function(n){var t;null===(t=null==n?void 0:n.parentElement)||void 0===t||t.replaceWith(n)},stroke:r,strokeWidth:o,version:"1.1",viewBox:"0 0 ".concat(e," ").concat(e),xmlns:"http://www.w3.org/2000/svg"},d.a.createElement("path",{d:"M".concat(i," L").concat(u," L").concat(c)}))},E=function(){return function(n){return function(t){return"message"!==t.activity.type||"bot"!==t.activity.from.role?n(t):function(){var e=Object(f.useRef)(null),r=v(),o=m(r,1),a=o[0],i=a.bubbleBorderColor,u=a.bubbleBorderWidth,c=a.bubbleNubSize,l=a.bubbleBackground;return Object(f.useLayoutEffect)((function(){null!=e.current&&c&&e.current.querySelectorAll("div.webchat__bubble.webchat__bubble--hide-nub.webchat__bubble--nub-on-top > div.webchat__bubble__content").forEach((function(n){var t,e=document.createElement("span");n.insertAdjacentElement("afterend",e);var r=n.parentElement;null==r||r.classList.add("webchat__bubble_has_nub"),null===(t=null==r?void 0:r.parentElement)||void 0===t||t.classList.remove("webchat__stacked_item_indented"),Object(A.render)(d.a.createElement(d.a.StrictMode,null,d.a.createElement(h,{fill:l,nubSize:c,stroke:i,strokeWidth:u})),e)}))}),[]),d.a.createElement("span",{ref:e},n(t).apply(void 0,arguments))}}}},C=Object(f.createContext)({primaryFont:"'Open Sans','Arial','Calibri','Helvetica Neue','sans-serif'",loadingColor:"#000000"});p.hooks.useStyleOptions;var g=function(){return function(n){return function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var o=e[0];return"messageReaction"!==o.activity.type&&n.apply(void 0,e)}}};function S(n){var t=n.replace(/[\[\]]/g,"\\$&"),e=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(window.location.href);if(null!=e)return e[2]?decodeURIComponent(e[2].replace(/\+/g," ")):""}function w(n,t){return function(n){if(Array.isArray(n))return n}(n)||function(n,t){var e=null==n?null:"undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null==e)return;var r,o,a=[],i=!0,u=!1;try{for(e=e.call(n);!(i=(r=e.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(n){u=!0,o=n}finally{try{i||null==e.return||e.return()}finally{if(u)throw o}}return a}(n,t)||function(n,t){if(!n)return;if("string"==typeof n)return B(n,t);var e=Object.prototype.toString.call(n).slice(8,-1);"Object"===e&&n.constructor&&(e=n.constructor.name);if("Map"===e||"Set"===e)return Array.from(n);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return B(n,t)}(n,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function B(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=n[e];return r}var _=function(n){var t;return"webchat/start"===(null===(t=n.data)||void 0===t?void 0:t.type)},k={isStarted:!0,trigger:"bootstrap"},x=[".webchat__basic-transcript",".webchat__basic-transcript__sentinel",".webchat__basic-transcript__terminator","div~.webchat__basic-transcript__activity-sentinel"].join(", "),O=function(){return document.querySelectorAll(x).forEach((function(n){n.removeAttribute("tabindex")}))},j=function(){Object(f.useEffect)(O,[])},T=function(){return function(n){return function(){var t=arguments.length<=0?void 0:arguments[0],e=t.activity.attachments,r=n.apply(void 0,arguments);return"function"!=typeof r?r:(null==e?void 0:e.some((function(n){return"application/vnd.microsoft.card.adaptive"==n.contentType})))?function(){j();var n=Object(f.useRef)(null);return Object(f.useLayoutEffect)((function(){var t,e,r,o;null===(t=n.current)||void 0===t||t.querySelectorAll("[aria-roledescription=attachment]").forEach((function(n){n.setAttribute("aria-roledescription","message")})),null===(e=n.current)||void 0===e||e.querySelectorAll("[role=menubar] [role=menuitem]").forEach((function(n){n.setAttribute("role","listitem")})),null===(r=n.current)||void 0===r||r.querySelectorAll("[role=menubar] [role=button]").forEach((function(n){n.setAttribute("role","listitem")})),null===(o=n.current)||void 0===o||o.querySelectorAll("[role=menubar]").forEach((function(n){n.setAttribute("role","list")}))}),[]),d.a.createElement("div",{ref:n},r.apply(void 0,arguments))}:function(){return j(),d.a.createElement(d.a.Fragment,null,r.apply(void 0,arguments))}}}},I=e(106),L=e.n(I);var F=I.hooks.usePostActivity,N=function(n){return{type:"event",name:"openURL",value:n}},R=function(n){return{type:"event",name:"openWebSearchResultURL",value:n}},P=function(){return function(n){return function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var o=e[0].activity,a=n.apply(void 0,e);if("message"===o.type&&a)return function(){var n=Object(f.useRef)(null),t=F();return Object(f.useLayoutEffect)((function(){var e,r,a=!!(null===(e=o.attachments)||void 0===e?void 0:e.find((function(n){return"WEB_SEARCH_RESULT_ATTACHMENT"===n.name})));null===(r=n.current)||void 0===r||r.querySelectorAll("[aria-roledescription=message]").forEach((function(n,e){n.querySelectorAll("a").forEach((function(n){n.onclick=function(){var r={url:n.href,sourceActivityId:o.id,answerIndex:e,linkText:n.text};t(a?R(r):N(r))}}))}))})),d.a.createElement("div",{ref:n},a.apply(void 0,arguments))}}}},U=I.hooks.useSendMessageBack,M=function(){return function(n){return function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var o=e[0].activity,a=n.apply(void 0,e);if("message"===o.type&&a)return function(){var n=Object(f.useRef)(null),t=U();return Object(f.useLayoutEffect)((function(){var e;null===(e=n.current)||void 0===e||e.querySelectorAll("[aria-roledescription=message]").forEach((function(n){n.querySelectorAll("a").forEach((function(n){var e,r=new URL(n.href),a=r.searchParams.get("intent"),i=r.searchParams.get("context");if(a&&i){var u=n.text,c=document.createElement("button");c.onclick=function(){var n={type:"linkedAnswer",title:u,intentId:a,context:{intentId:i,activityId:o.id}};t(n,u,u)},c.textContent=u,c.className="bffButtonLink",c.title="Ask about ".concat(u),null===(e=n.parentNode)||void 0===e||e.replaceChild(c,n)}}))}))})),d.a.createElement("div",{ref:n},a.apply(void 0,arguments))}}}};function W(n,t){return function(n){if(Array.isArray(n))return n}(n)||function(n,t){var e=null==n?null:"undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null==e)return;var r,o,a=[],i=!0,u=!1;try{for(e=e.call(n);!(i=(r=e.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(n){u=!0,o=n}finally{try{i||null==e.return||e.return()}finally{if(u)throw o}}return a}(n,t)||function(n,t){if(!n)return;if("string"==typeof n)return q(n,t);var e=Object.prototype.toString.call(n).slice(8,-1);"Object"===e&&n.constructor&&(e=n.constructor.name);if("Map"===e||"Set"===e)return Array.from(n);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return q(n,t)}(n,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function q(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=n[e];return r}function D(n){return(D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}var Y=I.Components.AdaptiveCardContent,z=I.hooks.useSuggestedActions,X=I.hooks.usePostActivity,H=function(n){var t,e,r=W(d.a.useState({activity:n.activity,attachment:n.attachment}),1)[0];Object(f.useLayoutEffect)((function(){!function n(t,e){if("Action.Submit"===t.type){var r=function(n,t){if(null!=n){var e=n.value||n.data;if(null!=e&&e.type&&(!t||e.type===t))return e}}(t,"linkedAnswer");r&&(r.context.activityId=e)}else{(Array.isArray(t)?t:Object.values(t)).filter((function(n){return null!=n&&"object"===D(n)})).forEach((function(t){return n(t,e)}))}}(r.attachment.content,r.activity.id)}),[r.activity,r.attachment]);var o=X(),a=W(Object(f.useState)(),2),i=a[0],u=a[1],c=r.activity.channelData||{},l=r.activity.id,s=W(z(),1)[0],A=Object(f.useCallback)((function(n){var t=n.currentTarget.getAttribute("data-reaction"),e=n.currentTarget.getAttribute("data-intent-id");null!=t&&null!=e&&(o(function(n,t,e){return{type:"messageReaction",reactionsAdded:[{type:n,intentId:t}],replyToId:e}}(t,e,l)),u(t))}),[c,o,l,u]),b=Object(f.useCallback)((function(){var n,t,e=c.webSearch;e&&o((n=e.query,t=e.intentId,{type:"message",value:{type:"searchRelatedToAnswer",searchTerm:n,intentId:t},replyToId:l}))}),[c.webSearch,o,l]);return d.a.createElement("div",null,d.a.createElement(Y,{content:r.attachment.content}),((null===(t=c.allowedReactions)||void 0===t?void 0:t.length)||c.webSearch)&&d.a.createElement("div",{className:"bffCardAttachment__buttonBar"},null===(e=c.allowedReactions)||void 0===e?void 0:e.map((function(n,t){return d.a.createElement("button",{onClick:A,key:t,disabled:s.length||i,"aria-label":n.spokenLabel||n.label,"data-reaction":n.type,"data-intent-id":n.intentId,"data-chosen":i==n.type},n.label)})),c.webSearch&&d.a.createElement("button",{onClick:b,"aria-label":c.webSearch.spokenLabel||c.webSearch.label},c.webSearch.label)))},G=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(n);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(n,r[o])&&(e[r[o]]=n[r[o]])}return e},V=function(){return function(n){return function(t){var e=t.activity,r=t.attachment,o=G(t,["activity","attachment"]);switch(r.contentType){case"application/vnd.microsoft.card.adaptive":return d.a.createElement(H,{activity:e,attachment:r});default:return n(Object.assign({activity:e,attachment:r},o))}}}},Z=e(323),$=e.n(Z),J=e(432),K=function(n){var t=n.dispatch;return function(n){return function(e){var r,o,a;if(e.type===Z.SEND_MESSAGE_BACK)e.payload.text=null!==(r=e.payload.text)&&void 0!==r?r:e.payload.displayText;else if(e.type===J.SEND_POST_BACK){var i=null!==(a=null===(o=e.payload)||void 0===o?void 0:o.value)&&void 0!==a?a:{},u=i.title;if("linkedAnswer"===i.type&&u)return void t($()(e.payload.value,u,u))}return n(e)}}};var Q,nn=e(77),tn=e(204),en=e(321),rn=e(322),on=e(250),an=e(251);function un(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}var cn=(un(Q={},nn.POST_ACTIVITY,!0),un(Q,tn.SET_SEND_BOX,!0),un(Q,en.START_DICTATE,!0),un(Q,on.STOP_DICTATE,!0),un(Q,rn.START_SPEAKING_ACTIVITY,!0),un(Q,an.STOP_SPEAKING_ACTIVITY,!0),Q);var ln=e(207),sn=function(n){var t=n.dispatch;return function(n){return function(e){return"DIRECT_LINE/CONNECT_FULFILLED"===e.type&&t({type:"DIRECT_LINE/POST_ACTIVITY",meta:{method:"keyboard"},payload:{activity:{type:"typing",from:{role:"user"}}}}),n(e)}}},fn=function(n){var t=n.displayText,e=void 0===t?"preparing your experience...":t,r=Object(f.useContext)(C),o={"--theme-color":r.loadingColor,"--default-fonts":r.primaryFont};return d.a.createElement("div",{className:"loader",style:o},d.a.createElement("span",{className:"loader-outer"},d.a.createElement("span",{className:"loader-inner"})),d.a.createElement("span",{className:"loader-label"},e))},dn=function(){return(dn=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e])Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n}).apply(this,arguments)},An=function(n){return function(){return function(t){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var o=n.timestamp,a=n.sendStatus,i=e[0],u=i.activity,c=u.from,l=c.role,s=c.name,f=u.type,A=u.timestamp,b=i.sendState,p=i.sameTimestampGroup;if("message"===f){if("sending"===b)return t.apply(void 0,e);if("send failed"===b)return t.apply(void 0,e);if(!p){var m=dn(dn({},o),a);return d.a.createElement("span",{className:"activityStatus activityStatus__timestamp"},d.a.createElement("span",{className:"activityStatus__timestampContent",style:m},"user"===l?"you":s+" at "+new Date(A).toLocaleTimeString()))}}return t.apply(void 0,e)}}}},bn=e(626),pn=e.n(bn);var mn=["-apple-system","BlinkMacSystemFont","Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue","sans-serif"].map((function(n){return"'".concat(n,"'")})).join(", "),yn={small:10,default:16,medium:14,large:18,extraLarge:22},vn={lighter:200,default:400,bolder:600},hn={loadingColor:"#026540",primaryFont:mn},En={accent:"#026540",backgroundColor:"#E4E4E4",fontSizeSmall:"68.75%",autoScrollSnapOnPage:!0,bubbleBackground:"#FFFFFF",bubbleTextColor:"#333333",bubbleBorderRadius:8,bubbleBorderColor:"#FFFFFF",bubbleNubSize:11,bubbleNubOffset:6,bubbleFromUserBackground:"#026540",bubbleFromUserTextColor:"#FFFFFF",bubbleFromUserBorderRadius:8,bubbleFromUserBorderColor:"#026540",bubbleFromUserNubSize:11,bubbleFromUserNubOffset:6,suggestedActionBorderColor:"#026540",suggestedActionBorderRadius:6,suggestedActionBorderStyle:"solid",suggestedActionBorderWidth:0,suggestedActionBackground:"#026540",suggestedActionTextColor:"#000000",primaryFont:mn,richCardWrapTitle:!0,hideUploadButton:!0,timestampFormat:"absolute",timestampColor:"#333333",sendBoxHeight:48,sendBoxBorderBottom:"solid 2px #999999",sendBoxBorderLeft:"solid 2px #999999",sendBoxBorderRight:"solid 2px #999999",sendBoxBorderTop:"solid 2px #999999"},Cn=pn()(En);Cn.fontFamily=mn,Cn.fontSizes=yn,Cn.fontWeights=vn,Cn.containerStyles.default.foregroundColors.default.default=En.bubbleTextColor;var gn=function(n){return function(){window.parent.postMessage(n,"*")}},Sn=gn({type:"ready"}),wn=(gn({type:"error"}),gn({type:"reload"}),gn("loopFocusForward"),gn("loopFocusForwardError"),gn("addOnBackwardsTabbing"),gn("loopFocusForwardOptionButton"),gn("errorDisplayed"),gn("textboxFocus"),/rfm[\s-]?\d{2,3}/gi),Bn=/([\d\D]{2})(\d+)/g;function _n(n,t,e){void 0===e&&(e=0);var r,o=[];do{if(r=n.exec(t)){var a=e>0?r.index+r.slice(1,e).reduce((function(n,t){return n+t.length}),0):r.index;o.push({index:a,text:r[e]})}}while(r);return o}var kn=function(){return function(n){return function(t){if(t.type===ln.SEND_MESSAGE){var e=_n(wn,t.payload.text),r=t.payload.text.replace(wn,"_rfm_placeholder_"),o=_n(Bn,r,2),a=r;o.forEach((function(n){a=function(n,t,e){return t.substring(0,n.index)+e.padEnd(n.text.length,e)+t.substring(n.index+n.text.length)}(n,a,"*")})),e.forEach((function(n){var t,e,r;t=n,r="_rfm_placeholder_",a=(e=a).substring(0,t.index)+t.text+e.substring(t.index+r.length)})),t.payload.text=a}return n(t)}}},xn=function(){return(xn=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e])Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n}).apply(this,arguments)},On=function(n,t,e,r){return new(e||(e=Promise))((function(o,a){function i(n){try{c(r.next(n))}catch(n){a(n)}}function u(n){try{c(r.throw(n))}catch(n){a(n)}}function c(n){var t;n.done?o(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(i,u)}c((r=r.apply(n,t||[])).next())}))},jn=function(n,t){var e,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(n,i)}catch(n){a=[6,n],r=0}finally{e=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},Tn=function(n,t){for(var e=0,r=t.length,o=n.length;e<r;e++,o++)n[o]=t[e];return n},In=function(){var n,t,e=function(){var n,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_;if("true"==(null===(n=S("bootstrap"))||void 0===n?void 0:n.toLowerCase()))return k;var e=Object(f.useState)({isStarted:!1}),r=w(e,2),o=r[0],a=r[1];return Object(f.useEffect)((function(){var n=function n(e){o.isStarted||t(e)&&(window.removeEventListener("message",n),a({isStarted:!0,trigger:e}))};return window.addEventListener("message",n),function(){return window.removeEventListener("message",n)}}),[]),o}((function(n){var t,e;return"Welcome"===(null===(e=null===(t=n.data)||void 0===t?void 0:t.query)||void 0===e?void 0:e.id)})),r=Object(f.useState)(),o=r[0],a=r[1],i=Object(f.useState)(),u=i[0],c=i[1],l=Object(f.useState)(!1),s=l[0],A=l[1],b=Object(f.useState)(),p=b[0],m=b[1],y=Object(f.useRef)(null);n=y,Object(f.useLayoutEffect)((function(){var e,r,o;if(null===(r=null===(e=n.current)||void 0===e?void 0:e.querySelector("input[data-id='webchat-sendbox-input']"))||void 0===r||r.setAttribute("maxlength","500"),null==t?void 0:t.sendButtonImgSrc){var a=null===(o=n.current)||void 0===o?void 0:o.querySelector(".webchat__send-button");if(a){for(;null!=a.firstChild;)a.removeChild(a.firstChild);var i=document.createElement("IMG");i.setAttribute("src",t.sendButtonImgSrc),i.setAttribute("role","none"),i.classList.add("webchat__send-icon"),a.appendChild(i)}}}),[n.current]);var v=Object(f.useMemo)((function(){return Object(I.createStyleSet)(En)}),[]),h=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:400;return function(){return function(e){return function(r){return"DIRECT_LINE/CONNECT_FULFILLED"===r.type&&setTimeout((function(){n()}),t),e(r)}}}}((function(){return A(!0)})),B=Object(f.useCallback)((function(){return On(void 0,void 0,void 0,(function(){var n,t,e;return jn(this,(function(r){switch(r.label){case 0:return A(!1),[4,On(void 0,void 0,void 0,(function(){var n,t;return jn(this,(function(e){switch(e.label){case 0:return n=S("Token"),[4,fetch("/api/webchat",{method:"POST",body:JSON.stringify({}),headers:{"Content-Type":"application/json",Authorization:"Bearer "+n}}).then((function(n){return n.json()}))];case 1:return(t=e.sent()).directLineConfig.continueConversation&&(t.directLineConfig.conversationId=t.directLineConfig.conversationIdForToken),[2,t]}}))}))];case 1:return n=r.sent(),t=[sn,kn,K,h],null!=n.idleConversationTimeoutMS&&n.idleConversationTimeoutMS>0&&t.push((o=B,i=n.idleConversationTimeoutMS,function(){return function(n){return function(t){return cn[t.type]&&(u&&clearTimeout(u),u=setTimeout((function(){return o()}),i)),n(t)}}})),c(I.createStore.apply(void 0,Tn([{}],t))),e=xn(xn({},n.directLineConfig),{watermark:"-",webSocket:!!n.directLineConfig.webSocket&&void 0}),a(Object(I.createDirectLine)(e)),m(n),[2]}var o,i,u}))}))}),[c,a,A]);Object(f.useEffect)((function(){e.isStarted&&On(void 0,void 0,void 0,(function(){return jn(this,(function(n){switch(n.label){case 0:return[4,B()];case 1:return n.sent(),[2]}}))}))}),[e]),Object(f.useEffect)((function(){Sn()}),[]),Object(f.useEffect)((function(){var n=document.getElementsByClassName("webchat__icon-button").item(0);n&&(n.innerHTML="Send")}),[s]),Object(f.useEffect)((function(){s&&p&&e.isStarted&&On(void 0,void 0,void 0,(function(){return jn(this,(function(n){switch(n.label){case 0:return[4,(t={token:p.directLineConfig.token,userId:p.directLineConfig.userId,conversationId:p.directLineConfig.conversationIdForToken,isResumed:p.directLineConfig.continueConversation},On(void 0,void 0,void 0,(function(){return jn(this,(function(n){switch(n.label){case 0:return[4,fetch("/api/events/conversationStarted",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).then((function(n){return n.json()}))];case 1:return[2,n.sent()]}}))})))];case 1:return n.sent(),[2]}var t}))}))}),[s,p,e]);return d.a.createElement(C.Provider,{value:hn},d.a.createElement("div",{className:"h-100"},s||d.a.createElement(fn,null),d.a.createElement("div",{className:"h-100"+(s?"":" d-none")},o&&d.a.createElement("div",{className:"h-100",ref:y},d.a.createElement(L.a,{activityMiddleware:[g,E,T,M,P],activityStatusMiddleware:An(v),adaptiveCardsHostConfig:Cn,attachmentMiddleware:V,className:"reactWebChat web-chat",directLine:o,store:u,styleOptions:En,extraStyleSet:v,overrideLocalizedStrings:{TEXT_INPUT_PLACEHOLDER:"Type your question..."}})))))},Ln=function(){return d.a.createElement(In,null)};b.a.render(d.a.createElement(Ln,null),document.getElementById("webchat"))},265:function(n,t){},645:function(n,t,e){"use strict";var r=e(254),o=e.n(r),a=e(255),i=e.n(a)()(o.a);i.push([n.i,".bffCardAttachment__buttonBar {\n  text-align: right;\n  width: 100%;\n  box-sizing: border-box;\n  padding: 0 14px 14px 14px;\n}\n\n.bffCardAttachment__buttonBar button {\n  cursor: pointer;\n}\n\n.bffCardAttachment__buttonBar button:not(:first-child) {\n  margin-left: 4px;\n}\n.bffCardAttachment__buttonBar button {\n  border: none;\n  background: transparent;\n  font-size: 1.1rem;\n  opacity: 0.75;\n  transition: all 0.12s;\n}\n.bffCardAttachment__buttonBar button:disabled {\n  cursor: default;\n  color: grey;\n  opacity: 1;\n}\n.bffCardAttachment__buttonBar button:disabled:not([data-chosen='true']) {\n  opacity: 0.4;\n}\n.bffCardAttachment__buttonBar button:hover:not(:disabled) {\n  opacity: 1;\n  transform: scale(1.12, 1.12);\n}\n","",{version:3,sources:["webpack://./../../bff/bff-webchat-ui/dist/components/bffAnswerAdaptiveCard.css"],names:[],mappings:"AAAA;EACE,iBAAiB;EACjB,WAAW;EACX,sBAAsB;EACtB,yBAAyB;AAC3B;;AAEA;EACE,eAAe;AACjB;;AAEA;EACE,gBAAgB;AAClB;AACA;EACE,YAAY;EACZ,uBAAuB;EACvB,iBAAiB;EACjB,aAAa;EACb,qBAAqB;AACvB;AACA;EACE,eAAe;EACf,WAAW;EACX,UAAU;AACZ;AACA;EACE,YAAY;AACd;AACA;EACE,UAAU;EACV,4BAA4B;AAC9B",sourcesContent:[".bffCardAttachment__buttonBar {\n  text-align: right;\n  width: 100%;\n  box-sizing: border-box;\n  padding: 0 14px 14px 14px;\n}\n\n.bffCardAttachment__buttonBar button {\n  cursor: pointer;\n}\n\n.bffCardAttachment__buttonBar button:not(:first-child) {\n  margin-left: 4px;\n}\n.bffCardAttachment__buttonBar button {\n  border: none;\n  background: transparent;\n  font-size: 1.1rem;\n  opacity: 0.75;\n  transition: all 0.12s;\n}\n.bffCardAttachment__buttonBar button:disabled {\n  cursor: default;\n  color: grey;\n  opacity: 1;\n}\n.bffCardAttachment__buttonBar button:disabled:not([data-chosen='true']) {\n  opacity: 0.4;\n}\n.bffCardAttachment__buttonBar button:hover:not(:disabled) {\n  opacity: 1;\n  transform: scale(1.12, 1.12);\n}\n"],sourceRoot:""}]),t.a=i},646:function(n,t,e){"use strict";var r=e(254),o=e.n(r),a=e(255),i=e.n(a)()(o.a);i.push([n.i,".loader {\n  font-family: var(--default-fonts);\n  position: absolute;\n  top: 50%;\n  text-align: center;\n  width: 100%;\n  margin: 0 auto;\n}\n\n.loader-outer {\n  display: inline-block;\n  width: 30px;\n  height: 30px;\n  border-radius: 3px;\n  border: 4px solid var(--theme-color);\n  animation: loader 4s infinite ease;\n  -webkit-animation: loader 4s infinite ease;\n}\n\n.loader-inner {\n  vertical-align: top;\n  display: inline-block;\n  width: 100%;\n  background-color: var(--theme-color);\n  animation: loader-inner 4s infinite ease-in;\n  -webkit-animation: loader-inner 4s infinite ease-in;\n}\n\n.loader-label {\n  padding: 16px;\n  color: #333333;\n  display: block;\n  font-size: medium;\n  font-weight: lighter;\n}\n\n@-webkit-keyframes loader {\n  0% {\n    -webkit-transform: rotate(0deg);\n  }\n\n  25% {\n    -webkit-transform: rotate(180deg);\n  }\n\n  50% {\n    -webkit-transform: rotate(180deg);\n  }\n\n  75% {\n    -webkit-transform: rotate(360deg);\n  }\n\n  100% {\n    -webkit-transform: rotate(360deg);\n  }\n}\n\n@-webkit-keyframes loader-inner {\n  0% {\n    height: 0;\n  }\n\n  25% {\n    height: 0;\n  }\n\n  50% {\n    height: 100%;\n  }\n\n  75% {\n    height: 100%;\n  }\n\n  100% {\n    height: 0;\n  }\n}\n\n@keyframes loader {\n  0% {\n    transform: rotate(0deg);\n  }\n\n  25% {\n    transform: rotate(180deg);\n  }\n\n  50% {\n    transform: rotate(180deg);\n  }\n\n  75% {\n    transform: rotate(360deg);\n  }\n\n  100% {\n    transform: rotate(360deg);\n  }\n}\n\n@keyframes loader-inner {\n  0% {\n    height: 0;\n  }\n\n  25% {\n    height: 0;\n  }\n\n  50% {\n    height: 100%;\n  }\n\n  75% {\n    height: 100%;\n  }\n\n  100% {\n    height: 0;\n  }\n}\n","",{version:3,sources:["webpack://./../../bff/bff-webchat-ui/dist/components/loadingState.css"],names:[],mappings:"AAAA;EACE,iCAAiC;EACjC,kBAAkB;EAClB,QAAQ;EACR,kBAAkB;EAClB,WAAW;EACX,cAAc;AAChB;;AAEA;EACE,qBAAqB;EACrB,WAAW;EACX,YAAY;EACZ,kBAAkB;EAClB,oCAAoC;EACpC,kCAAkC;EAClC,0CAA0C;AAC5C;;AAEA;EACE,mBAAmB;EACnB,qBAAqB;EACrB,WAAW;EACX,oCAAoC;EACpC,2CAA2C;EAC3C,mDAAmD;AACrD;;AAEA;EACE,aAAa;EACb,cAAc;EACd,cAAc;EACd,iBAAiB;EACjB,oBAAoB;AACtB;;AAEA;EACE;IACE,+BAA+B;EACjC;;EAEA;IACE,iCAAiC;EACnC;;EAEA;IACE,iCAAiC;EACnC;;EAEA;IACE,iCAAiC;EACnC;;EAEA;IACE,iCAAiC;EACnC;AACF;;AAEA;EACE;IACE,SAAS;EACX;;EAEA;IACE,SAAS;EACX;;EAEA;IACE,YAAY;EACd;;EAEA;IACE,YAAY;EACd;;EAEA;IACE,SAAS;EACX;AACF;;AAEA;EACE;IACE,uBAAuB;EACzB;;EAEA;IACE,yBAAyB;EAC3B;;EAEA;IACE,yBAAyB;EAC3B;;EAEA;IACE,yBAAyB;EAC3B;;EAEA;IACE,yBAAyB;EAC3B;AACF;;AAEA;EACE;IACE,SAAS;EACX;;EAEA;IACE,SAAS;EACX;;EAEA;IACE,YAAY;EACd;;EAEA;IACE,YAAY;EACd;;EAEA;IACE,SAAS;EACX;AACF",sourcesContent:[".loader {\n  font-family: var(--default-fonts);\n  position: absolute;\n  top: 50%;\n  text-align: center;\n  width: 100%;\n  margin: 0 auto;\n}\n\n.loader-outer {\n  display: inline-block;\n  width: 30px;\n  height: 30px;\n  border-radius: 3px;\n  border: 4px solid var(--theme-color);\n  animation: loader 4s infinite ease;\n  -webkit-animation: loader 4s infinite ease;\n}\n\n.loader-inner {\n  vertical-align: top;\n  display: inline-block;\n  width: 100%;\n  background-color: var(--theme-color);\n  animation: loader-inner 4s infinite ease-in;\n  -webkit-animation: loader-inner 4s infinite ease-in;\n}\n\n.loader-label {\n  padding: 16px;\n  color: #333333;\n  display: block;\n  font-size: medium;\n  font-weight: lighter;\n}\n\n@-webkit-keyframes loader {\n  0% {\n    -webkit-transform: rotate(0deg);\n  }\n\n  25% {\n    -webkit-transform: rotate(180deg);\n  }\n\n  50% {\n    -webkit-transform: rotate(180deg);\n  }\n\n  75% {\n    -webkit-transform: rotate(360deg);\n  }\n\n  100% {\n    -webkit-transform: rotate(360deg);\n  }\n}\n\n@-webkit-keyframes loader-inner {\n  0% {\n    height: 0;\n  }\n\n  25% {\n    height: 0;\n  }\n\n  50% {\n    height: 100%;\n  }\n\n  75% {\n    height: 100%;\n  }\n\n  100% {\n    height: 0;\n  }\n}\n\n@keyframes loader {\n  0% {\n    transform: rotate(0deg);\n  }\n\n  25% {\n    transform: rotate(180deg);\n  }\n\n  50% {\n    transform: rotate(180deg);\n  }\n\n  75% {\n    transform: rotate(360deg);\n  }\n\n  100% {\n    transform: rotate(360deg);\n  }\n}\n\n@keyframes loader-inner {\n  0% {\n    height: 0;\n  }\n\n  25% {\n    height: 0;\n  }\n\n  50% {\n    height: 100%;\n  }\n\n  75% {\n    height: 100%;\n  }\n\n  100% {\n    height: 0;\n  }\n}\n"],sourceRoot:""}]),t.a=i},647:function(n,t,e){"use strict";var r=e(254),o=e.n(r),a=e(255),i=e.n(a)()(o.a);i.push([n.i,".bffButtonLink {\n  display: inline-block;\n  border: none;\n  padding: 0;\n  text-decoration: underline;\n  color: blue;\n  cursor: pointer;\n  font: inherit;\n  background-color: transparent;\n}\n\n.bffButtonLink:active {\n  color: red;\n}\n","",{version:3,sources:["webpack://./../../bff/bff-webchat-ui/dist/components/bffButtonLink.css"],names:[],mappings:"AAAA;EACE,qBAAqB;EACrB,YAAY;EACZ,UAAU;EACV,0BAA0B;EAC1B,WAAW;EACX,eAAe;EACf,aAAa;EACb,6BAA6B;AAC/B;;AAEA;EACE,UAAU;AACZ",sourcesContent:[".bffButtonLink {\n  display: inline-block;\n  border: none;\n  padding: 0;\n  text-decoration: underline;\n  color: blue;\n  cursor: pointer;\n  font: inherit;\n  background-color: transparent;\n}\n\n.bffButtonLink:active {\n  color: red;\n}\n"],sourceRoot:""}]),t.a=i}});
//# sourceMappingURL=main.edd90a1d2353255129c9.js.map