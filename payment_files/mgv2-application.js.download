(function(global){global.maxMobileScreenWidth=992;global.getUrlParams=function(){var hashes=(window.location.href.split("?")[1]||"").split("&");var params={};for(var i=0;i<hashes.length;i++){var hash=hashes[i].split("=");params[hash[0]]=hash[1];}return params;};global.getAndroidVersion=function(ua){var match=(ua||navigator.userAgent).match(/android\s([0-9\.]*)/i);if(match){return parseFloat(match[1]);}};global.isTouchDevice=(function(){try{document.createEvent("TouchEvent");return true;}catch(e){return false;}})();global.oneUseEvent=function(element,event,fn){function handler(e){fn.call(this,e);this.removeEventListener(event,handler);}element.addEventListener(event,handler);};$(function(){global.isMobileDevice=$(window).width()<=global.maxMobileScreenWidth&&global.isTouchDevice;});})(window.global=window.global||{});$(document).ready(function(){var $menuHitbox=$(".menu-hitbox");$menuHitbox.on("click",function(e){var $this=$(this);if(!$this.hasClass("open")){$this.addClass("open");$this.siblings(".global-menu").slideDown(function(){$this.addClass("open-on-mobile");$(this).removeAttr("style");});$this.find(".text").text("Close");}else{$this.removeClass("open");$this.siblings(".global-menu").slideUp(function(){$this.removeClass("open-on-mobile");$(this).removeAttr("style");});$this.find(".text").text("Menu");}});$menuHitbox.on("keyup",function(e){if(e.which==13){$menuHitbox.trigger("click");}});});$(document).ready(function(){cleanDefaultValues();$(".button-main").on("mousedown",function(event){if(event.button&&event.button!==0){return;}$("form input:visible:enabled").each(function(){if($(this).attr("data-new-password")!==null||$(this).attr("data-reenter-password")!==null){$(this).trigger("blur");}else{$(this).val($(this).val().trim());$(this).trigger("blur");}});if($("form").find(".hasError").length!=0){$("form").find(".hasError:first > input").focus();event.preventDefault?event.preventDefault():(event.returnValue=false);}$(this).trigger("click");});$("form input").on("keypress",function(event){var charCode=event.charCode||event.keyCode||event.which;if(charCode==13){event.preventDefault?event.preventDefault():(event.returnValue=false);$(".button-main").trigger("mousedown");}});$(".button-main").on("click",function(event){$("[dont-validate]").removeAttr("dont-validate");$("form input:visible:enabled").each(function(){var type=$(this).attr("type");if($(this).attr("data-new-password")!==null||$(this).attr("data-reenter-password")!==null){$(this).trigger("blur");}else{$(this).val($(this).val().trim());$(this).trigger("blur");}});if($("form").find(".hasError").length!=0){$("form").find(".hasError:first > input").focus();event.preventDefault?event.preventDefault():(event.returnValue=false);}});$("[data-mandatory--input]").on("blur",function(){if((formHelper.isNotEmpty($(this).val()))){formHelper.clearError($(this));}else{formHelper.setError($(this),"<p>Require a value</p>");}});$("[data-mandatory--checkbox]").on("blur",function(){if($(this).is(":checked")){formHelper.clearError($(this));}else{formHelper.setError($(this),"<p>Check this box to continue</p>");}});$("form").preventDoubleSubmission();setErrorParent();});var cleanDefaultValues=function(){if($('input[name="formId"]').val()==="clkPersonalDetailsFast"){var label=$("label[for*=clkCRN] span");label.text(label.text()+" (optional)");var crn=$("input[name*=clkCRN]");if(crn.val()==="000000000Z"){crn.val("").css("color","inherit");}}};var setMandatoryValues=function(){if($('input[name="formId"]').val()==="clkPersonalDetailsFast"){var crn=$("input[name*=clkCRN]");if(crn!=null&&crn.val()===""){crn.css("color","transparent").val("000000000Z");}}};$.fn.preventDoubleSubmission=function(){$(this).on("submit",function(event){var $form=$(this);if($form.data("submitted")){event.preventDefault?event.preventDefault():(event.returnValue=false);}else{setMandatoryValues();$form.data("submitted",true);}});return this;};function findInfoOrErrorParent($elem,closestDefault){closestDefault=!closestDefault?"label":closestDefault;var $parent=$elem.closest($(closestDefault));if($elem.closest("fieldset")[0]!==undefined){$parent=$elem.closest($("fieldset"));}else{if($elem.closest(".poro-field-group")[0]!==undefined){$parent=$elem.closest($(".poro-field-group"));}else{if($elem.closest(".selectRadio")[0]!==undefined){$parent=$elem.closest($(".selectRadio"));}else{if($elem.closest(".raet-line")[0]!==undefined){$parent=$elem.closest(".raet-line");}else{if($elem.closest(".input-group")[0]!==undefined){$parent=$elem.closest(".input-group");}else{if($elem.closest(".pincode-input-container")[0]!==undefined){$parent=$elem.closest(".pincode-input-container");}}}}}}return $parent;}function findSuccessParent($elem){var $parent=$elem.closest($("label"));if($elem.closest("fieldset")[0]!==undefined){$parent=$elem.closest($("fieldset"));}else{if($elem.closest(".input-group")[0]!==undefined){$parent=$elem.closest(".input-group");}}return $parent;}function clearMessageType($parent,typeClass){var $msgContainer=$parent.find("."+typeClass+'[role="alert"]');var containerId=$msgContainer.attr("id");if(containerId){formHelper.removeDescription($parent.find('[aria-describedby~="'+containerId+'"]'),containerId);}$parent.removeClass(typeClass);$msgContainer.remove();}var setErrorParent=function(){$("form span.hasError").each(function(){var $elem=$(this);var $parent=findInfoOrErrorParent($elem);$parent.addClass("hasError");var $control=$parent.find("input,select");if($control&&$control.length===1){formHelper.associateMessageWithElement($control,$elem);$control.attr("aria-invalid",true);}});};var formHelper={replaceMessageClass:function($element,newClass){$element.removeClass("success");$element.removeClass("hasInfo");$element.removeClass("hasError");if(newClass){$element.addClass(newClass);}},clearAllMessages:function($parent,expectedMessageElementSelector){expectedMessageElementSelector=!expectedMessageElementSelector?"":expectedMessageElementSelector;var $msgContainer=$parent.find(expectedMessageElementSelector+'[role="alert"]');var containerId=$msgContainer.attr("id");if(containerId){formHelper.removeDescription($parent.find('[aria-describedby~="'+containerId+'"]'),containerId);}$parent.removeClass("hasError");$parent.removeClass("hasInfo");$parent.removeClass("success");$msgContainer.remove();},resetDefaultValue:function($elem){$elem.val($elem.prop("defaultValue"));},setButtonGroupValue:function($elem,value){$elem.children().each(function(){$(this).removeClass("active");});$elem.children().each(function(){if($(this).text()==value){$(this).addClass("active");return false;}});},getButtonGroupValue:function($elem,cb){var value=null;$elem.children().each(function(){if($(this).hasClass("active")){value=$(this).text();return false;}});return value;},clearError:function($elem){var $parent=findInfoOrErrorParent($elem);clearMessageType($parent,"hasError");$elem.attr("aria-invalid",null);},clearCodeError:function($elem){var $parent=findInfoOrErrorParent($elem,"div");clearMessageType($parent,"hasError");$elem.attr("aria-invalid",null);},clearInfo:function($elem){var $parent=findInfoOrErrorParent($elem);clearMessageType($parent,"hasInfo");$elem.attr("aria-invalid",null);},clearSuccess:function($elem){var $parent=findSuccessParent($elem);clearMessageType($parent,"success");$elem.attr("aria-invalid",null);},setMessage:function($elem,$parent,message,typeClass,ariaInvalid,elementType){elementType=!elementType?"span":elementType;ariaInvalid=!ariaInvalid?null:ariaInvalid;var $msgContainer=$("<"+elementType+">"+message+"</"+elementType+">").addClass("form-helper-message").addClass(typeClass).attr("role","alert").attr("aria-live","assertive").appendTo($parent);formHelper.replaceMessageClass($parent,typeClass);formHelper.associateMessageWithElement($elem,$msgContainer);$elem.attr("aria-invalid",ariaInvalid);return $msgContainer;},setError:function($elem,text){var $parent=findInfoOrErrorParent($elem);formHelper.clearAllMessages($parent,"span");formHelper.setMessage($elem,$parent,text,"hasError","true");},setCodeError:function($elem,text){var $parent=$elem.closest($("div"));formHelper.clearAllMessages($parent,"span");formHelper.setMessage($elem,$parent,text,"hasError","true");},setInfo:function($elem,text){var $parent=findInfoOrErrorParent($elem);formHelper.clearAllMessages($parent,"span");formHelper.setMessage($elem,$parent,text,"hasInfo");},setSuccess:function($elem,text){var $parent=findSuccessParent($elem);formHelper.clearAllMessages($parent,"span");formHelper.setMessage($elem,$parent,text,"success");},setErrorSelect:function($elem,text){formHelper.clearSuccess($elem);var errText,$msgContainer;var $parent=findInfoOrErrorParent($elem);errText=$parent.find("#errorSelect");if(errText[0]===undefined){errText="<span id='errorSelect' class='hasError'></span>";}$parent.append(errText).addClass("hasError");$msgContainer=$parent.find("#errorSelect");$msgContainer.html(text);},clearErrorSelect:function($elem){var $msgContainer;var $parent=findInfoOrErrorParent($elem);$msgContainer=$parent.find('span[id="errorSelect"]');$parent.removeClass("hasError");$msgContainer.remove();},isUserIdValid:function(userId){var unameRegex="^[ \t]*[a-zA-Z]{2}[0-9]{6}[ \t]*$";var unameRule=new RegExp(unameRegex);return unameRule.test(userId);},isEmailValid:function(emailAddress){var emailAddress=emailAddress.trim();var valid=emailAddress.search(/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/);return(valid===0);},isHomeNumberValid:function(number){var number=formHelper.spaceRemoved(number);var isNumber=formHelper.isNumber(number);if(isNumber){if(number.length===9&&number.substring(0,5)==="67232"){return true;}if(number.length===10&&number.substring(0,2).match("02|03|07|08")){return true;}}return false;},isWorkNumberValid:function(number){var number=formHelper.spaceRemoved(number);return(formHelper.isMobileValid(number)||formHelper.isHomeNumberValid(number));},isNumber:function(input){return(/^\d+$/).test(input);},isMobileValid:function(number){var number=formHelper.spaceRemoved(number);var isNumber=formHelper.isNumber(number);if(isNumber){if(number.length===10&&number.substring(0,2)==="04"){return true;}if(number.length===9&&number.substring(0,5)==="67235"){return true;}}return false;},isNotEmpty:function(val){return(val!=="");},isEmpty:function(val){return(val==="");},isTypingSame:function($this,$compareWith){var compareWithVal=$compareWith.val(),thisVal=$this.val(),curpos=thisVal.length-1,compareWithChar=compareWithVal.charAt(curpos),thisChar=thisVal.charAt(curpos),thisPortion=thisVal.substring(0,curpos),compareWithPotion=compareWithVal.substring(0,curpos),errMsg="",successMsg="";if(compareWithVal===thisVal){return true;}if(thisChar!==compareWithChar){return false;}if(thisPortion===compareWithPotion){formHelper.clearError($this);}},chkFieldIsEmpty:function($this){if(formHelper.isEmpty($this.val())){return true;}else{return false;}},chkTooManyCharacters:function($this,max){if($this.val().length>max){return true;}else{return false;}},chkNumberOnly:function($this){return(/^\d+$/g).test($this.val());},chkValidCode:function($this){return(/^(([0-9]){6})$/).test($this.val());},enableDate:function(){if($(".date-fields").length>0){$(".date-fields input").each(function(){$(".date-fields input").prop("disabled",false).attr("aria-disabled",false);});}},disableDate:function(){if($(".date-fields").length>0){$(".date-fields input").each(function(){$(".date-fields input").prop("disabled",true).attr("aria-disabled",true);formHelper.clearError($(".date-fields input"));$(".date-fields input").val("");});}},spaceRemoved:function(thisval){return thisval.replace(/ /g,"");},associateMessageWithElement:function($input,$message){const id=formHelper.ensureUniqueIdFor($input);const messageId=id+"__form-helper-message";$message.attr("id",messageId);formHelper.addDescription($input,messageId);},addDescription:function($element,descriptionId){const originalDescriptionAttr=$element.attr("aria-describedby");const descriptions=originalDescriptionAttr?originalDescriptionAttr.split(" "):[];if(descriptions.indexOf(descriptionId)===-1){descriptions.unshift(descriptionId);}$element.attr("aria-describedby",descriptions.join(" "));},removeDescription:function($element,descriptionId){const originalDescriptionAttr=$element.attr("aria-describedby");const descriptions=originalDescriptionAttr?originalDescriptionAttr.split(" "):[];const newDescriptionAttr=descriptions.filter(formHelper.checkEmptyElements(descriptionId)).toString().replace(/,/g," ");if(newDescriptionAttr.trim().length>0){$element.attr("aria-describedby",newDescriptionAttr);}else{$element.attr("aria-describedby",null);}},checkEmptyElements:function(descriptionId){return function(id){return id!==descriptionId;};},};(function(){var lastGeneratedIdNumber=0;function ensureUniqueIdFor($element){const originalId=$element.attr("id");if($element.attr("id")){return originalId;}else{var newId;var tries=0;do{newId="mgv-unique-element-"+(++lastGeneratedIdNumber);}while(tries<100&&$("#"+newId).length!=0);if(tries>=99){throw new Error("Could not generate an new ID");}$element.attr("id",newId);return newId;}}formHelper.ensureUniqueIdFor=ensureUniqueIdFor;})();(function($){$(".poro-date-fields-optional input").on("blur",function(){var testFuture=false,optional=true;updateDateField($(this),testFuture,optional);validateDate($(this));});$(".poro-date-fields-mandatory input").on("blur",function(){var testFuture=false,optional=false;updateDateField($(this),testFuture,optional);validateDate($(this));});$(".date-fields input").on("blur",function(){var testFuture=true,optional=false;updateDateField($(this),testFuture,optional);validateDate($(this),optional);});if($(".date-fields").length>0){var today=new Date();var dd=today.getDate().toString().length===1?"0"+today.getDate():today.getDate();var mm=(today.getMonth()+1).toString().length===1?"0"+(today.getMonth()+1):(today.getMonth()+1);var yyyy=today.getFullYear();if(dd!==undefined&&mm!==undefined&&yyyy!==undefined){$(".exampleDate").text("For example: "+dd+" "+mm+" "+yyyy);}}var validateDate=function($this,optional){var $parent=$this.closest($("fieldset")),date=$parent.find("[data-date]").val(),isDay=$this.attr("data-date-day")!==undefined,isMonth=$this.attr("data-date-month")!==undefined,isYear=$this.attr("data-date-year")!==undefined,thisval=$this.val(),isDateFilledIn=chkDateFilledIn($this);if(date===("NaN")||date===("future")){if(isDay){updateDayError($this,isDateFilledIn);}if(isMonth){updateMonthError($this,isDateFilledIn);}if(isYear){updateYearError($this,isDateFilledIn);}if((date==="NaN")&&isDateFilledIn){formHelper.setError($this,"<p>Enter a valid date in the format of DD/MM/YYYY</p>");}if((date==="future")&&isDateFilledIn){formHelper.setError($this,"<p>The date can't be in the future</p>");}}else{formHelper.clearError($this);}};var isValidDay=function(number){return(formHelper.isNumber(number)&&(number<32)&&(number>0));};var isValidMonth=function(number){return(formHelper.isNumber(number)&&(number<13)&&(number>0));};var isValidYear=function(number){var year=new Date().getFullYear();return(formHelper.isNumber(number)&&(number>year-150)&&(number.trim().length===4));};var chkDateFilledIn=function($elem){var $parent=$elem.closest($("fieldset"));if($parent!==undefined){day=$parent.find("[data-date-day]").val();month=$parent.find("[data-date-month]").val();year=$parent.find("[data-date-year]").val();if(formHelper.isNotEmpty(year)&&formHelper.isNotEmpty(month)&&formHelper.isNotEmpty(day)){return true;}}return false;};var updateDayError=function($day,isDateFilledIn){if(!isValidDay($day.val())){formHelper.setError($day,"<p>Enter a valid date in the format of DD/MM/YYYY</p>");}else{if(isDateFilledIn){formHelper.clearError($(this));}}};var updateMonthError=function($month,isDateFilledIn){if(!isValidMonth($month.val())){formHelper.setError($month,"<p>Enter a valid date in the format of DD/MM/YYYY</p>");}else{if(isDateFilledIn){formHelper.clearError($(this));}}};var updateYearError=function($year,isDateFilledIn){if(!isValidYear($year.val())){formHelper.setError($year,"<p>Enter a valid date in the format of DD/MM/YYYY</p>");}else{if(isDateFilledIn){formHelper.clearError($(this));}}};var updateDateField=function($this,testFuture,optional){var $parent=$this.closest($("fieldset")),now=moment(new Date(),"DD/MM/YYYY"),$year=$parent.find("[data-date-year]"),$day=$parent.find("[data-date-day]"),year=$parent.find("[data-date-year]").val(),month=$parent.find("[data-date-month]").val(),day=$parent.find("[data-date-day]").val(),isPartial=!($day.length>0),isDateFilledIn=chkDateFilledIn($year),$doc="";if(isPartial){if(month!==""||year!==""){$doc=month+"/"+year;validDate=isValidMonth(month)&&isValidYear(year);$("[data-date]").val("");}else{$("[data-date]").val("optional");}}else{if(optional){if(day!==""||month!==""||year!==""){$doc=day+"/"+month+"/"+year;validDate=isValidDay(day)&&isValidMonth(month)&&isValidYear(year);$("[data-date]").val("");}else{$("[data-date]").val("optional");}}else{$doc=day+"/"+month+"/"+year;validDate=isValidDay(day)&&isValidMonth(month)&&isValidYear(year);}}var dateOfChange=moment($doc,"DD/MM/YYYY"),duration=moment.duration(now.diff(dateOfChange)),days=duration.asDays(),inFuture=!(days>=0)&&(testFuture);if($("[data-date]").val()==="optional"){return;}else{if(!isDateFilledIn||!validDate){$("[data-date]").val("NaN");return;}else{if(!inFuture&&validDate&&isDateFilledIn){$("[data-date]").val($doc);}else{if(inFuture){$("[data-date]").val("future");}}}}};})(jQuery);(function($){$(document).ready(function(){var initToggle=function(){$(".showPassword").on("click",function(){var $this=$(this),$inputType,$passwordInput=$this.siblings("input"),relatedInputStr="";if($passwordInput.attr("data-new-password")!==undefined){relatedInputStr="data-reenter-password";}else{if($passwordInput.attr("data-new-pin")!==undefined){relatedInputStr="data-reenter-pin";}}if($passwordInput.attr("data-reenter-password")!==undefined){relatedInputStr="data-new-password";}else{if($passwordInput.attr("data-reenter-pin")!==undefined){relatedInputStr="data-new-pin";}}if(relatedInputStr!==""){$relatedElementInput=$("["+relatedInputStr+"]");$relatedElementInputButton=$relatedElementInput.siblings("button");}$inputType=$passwordInput.attr("type");if($inputType.toLowerCase()==="password"){setPwdHide($this);if(relatedInputStr!==""){setPwdHide($relatedElementInputButton);}}else{setPwdShow($this);if(relatedInputStr!==""){setPwdShow($relatedElementInputButton);}}});};var setPwdShow=function($this){var $passwordInput=$this.siblings("input");$showpasswordhelptext="Note: this will visually expose your password on the screen.";$showhelp=$("#show-hide-helpmsg");$passwordInput.attr("type","password");$this.attr("aria-label","Show password as plain text.").attr("aria-describedby","show-hide-helpmsg").html("Show");$showhelp.replaceWith("<p class='is-visuallyhidden' id='show-hide-helpmsg'>"+$showpasswordhelptext+"</p>");};var setPwdHide=function($this){var $passwordInput=$this.siblings("input");$passwordInput.attr("type","text");var $hidepasswordhelptext="Note: this will visually stop exposing your password on the screen.";$hidehelp=$("#show-hide-helpmsg");$this.attr("aria-label","Hide password").attr("aria-describedby","show-hide-helpmsg").html("Hide");$hidehelp.replaceWith("<p class='is-visuallyhidden' id='show-hide-helpmsg'>"+$hidepasswordhelptext+"</p>");};$('input[type="password"]').each(function(){var $this=$(this),showhide="";showhide='<button class="showPassword anchor" type="button" aria-describedby="show-hide-helpmsg" aria-label="Show password as plain text.">Show</button><p class="is-visuallyhidden" id="show-hide-helpmsg">Note: this will visually expose your password on the screen.</p>';$this.before(showhide);});$("[data-current-password]").on("focusout",function(){validateCurrentPwd($(this));});$("[data-new-password]").on("blur",function(){$relatedElementInput=$("[data-reenter-password]");validateNewPwd($(this));if(formHelper.isEmpty($(this).val())){formHelper.setError($(this),"<p>Enter your new password</p>");}if($relatedElementInput.val()!=""){$relatedElementInput.trigger("keyup");}});$("[data-reenter-password]").on("blur",function(){validateNewPwd($(this));if(formHelper.isEmpty($(this).val())){formHelper.setError($(this),"<p>Re-enter your new password</p>");}});$("[data-new-password]").on("keyup",function(){var errmsg="",password=$(this).val(),rule0=(/\s/g).test(password),rule1=formHelper.chkTooManyCharacters($(this),64);if(rule0){errmsg="<p>Your password can't contain spaces</p>";}else{if(rule1){errmsg="<p>Password cannot be longer than 64 characters</p>";}}if(errmsg!==""){formHelper.setError($(this),errmsg);}else{formHelper.clearError($(this));}});$("[data-reenter-password]").on("blur",function(){var $compareWith=$("[data-new-password]"),isSame=($(this).val()===$compareWith.val());if(formHelper.isEmpty($(this).val())){formHelper.setError($(this),"<p>Re-enter your new password</p>");}else{if(isSame){formHelper.setSuccess($(this),"<p>The passwords are the same</p>");}else{formHelper.setError($(this),"<p>The password you've re-entered doesn't match your new password</p>");}}});$("[data-reenter-password]").on("keyup",function(){var $compareWith=$("[data-new-password]"),isSame=formHelper.isTypingSame($(this),$compareWith),errMsg="",successMsg="";if(isSame!==undefined){if(isSame){errMsg="";successMsg="The passwords are the same";}else{errMsg="<p>The password you've re-entered doesn't match your new password</p>";successMsg="";}if(formHelper.isNotEmpty($(this).val())){(errMsg!=="")?formHelper.setError($(this),errMsg):formHelper.setSuccess($(this),successMsg);}}});initToggle();});var validateCurrentPwd=function($elem){if(formHelper.chkFieldIsEmpty($elem)){formHelper.setError($elem,"<p>Enter your current password</p>");}else{formHelper.clearError($elem);}};var isthreeSequential=function(char1,char2,char3){var next=String.fromCharCode(char1.charCodeAt()+1);if(char2===next){var afternext=String.fromCharCode(char2.charCodeAt()+1);return char3===afternext;}return false;};var isthreeRepeated=function(char1,char2,char3){if(char1===char2){return(char2===char3);}};var chkSeqRep=function(str){var count=0;for(var x=0;x<str.length;x++){var c=str.charAt(x);var d=str.charAt(x+1);var e=str.charAt(x+2);if(isthreeSequential(c,d,e)||isthreeRepeated(c,d,e)){var x=x+2;count++;}}return(count>1);};var validateNewPwd=function($elem){var password=$elem.val(),relatedInputStr,errStatus,curPwd=$("[data-current-password]").val(),rule1=!(/^(?=.*[0-9])(?=.*[a-zA-Z])(([a-zA-Z0-9\!\@\#\$\%\^\&\*]){7,})$/).test(password),rule1=!(/^.{7,}$/).test(password),rule1b=!(/^[\s\da-zA-Z!@#$%^&*]*$/).test(password),rule2=!(/(([a-zA-Z]){1,})+/).test(password),rule3=!(/(([0-9]){1,})+/).test(password),rule4=(/(.)\1{3,}/).test(password),rule5=(/(abcd|bcde|cdef|defg|efgh|fghi|ghij|hijk|ijkl|jklm|klmn|lmno|mnop|nopq|opqr|pqrs|qrst|rstu|stuv|tuvw|uvwx|vwxy|wxyz)+/i).test(password.toLowerCase()),rule6=(/(0123|1234|2345|3456|4567|5678|6789|7890)+/i).test(password.toLowerCase()),rule7=chkSeqRep(password),rule8=(/\s/g).test(password),rule9=formHelper.chkTooManyCharacters($elem,64),rule10=(password===curPwd);errmsg="";if(rule1){errmsg="Your password must have at least 7 characters.";}else{if(rule2){errmsg="Your password must include a letter.";}else{if(rule3){errmsg="Your password must include a number.";}else{if(rule4){errmsg="Your password can't have more than 3 of the same numbers or letters in a row.";}else{if(rule5){errmsg="Your password can't have more than 3 letters in alphabetical order.";}else{if(rule7){errmsg="Your password can't repeat a sequence of any 3 letters or numbers.";}else{if(rule8){errmsg="Your password can't contain spaces.";}else{if(rule6){errmsg="Your password can't have more than 3 numbers in numerical order.";}else{if(rule1b){errmsg="Your password can only use these special characters !@#$%^&*.";}else{if(rule9){errmsg="Password cannot be longer than 64 characters.";}else{if(rule10){errmsg="Your new password can't be the same as your current password.";}}}}}}}}}}}if(formHelper.isNotEmpty(password)){if(errmsg!=""){formHelper.setError($elem,"<p>"+errmsg+"</p>");}else{formHelper.clearError($elem);}}};})(jQuery);(function($){$(document).ready(function(){$("[data-email-address]").on("blur",function(){if($(this).val().trim()!==""){if(formHelper.isEmailValid($(this).val().trim())){formHelper.clearError($(this));}else{formHelper.setError($(this),"<p>Enter a valid email address. For example name@mail.com</p>");}}else{formHelper.clearError($(this));}});var contactNumber=function(){var $mobile=$("[data-mobile-number]"),$home=$("[data-home-number]"),$work=$("[data-work-number]");$("[data-mobile-number]").on("keyup",function(){if($(this).val()!=""){formHelper.enableDate();}else{if(($home.val()||$work.val())===""){formHelper.disableDate();}}});$("[data-home-number]").on("keyup",function(){if($(this).val()!=""){formHelper.enableDate();}else{if(($work.val()||$mobile.val())===""){formHelper.disableDate();}}});$("[data-work-number]").on("keyup",function(){if($(this).val()!=""){formHelper.enableDate();}else{if(($home.val()||$mobile.val())===""){formHelper.disableDate();}}});$("[data-mobile-number]").on("blur",function(){if($(this).val()!=""){formHelper.enableDate();if(formHelper.isMobileValid($(this).val())){formHelper.clearError($(this));}else{formHelper.setError($(this),"<p>Enter a valid Australian or Norfolk Island mobile number. Australian mobile numbers contain 10 digits and begin with 04</p>");}}else{formHelper.clearError($(this));if(($home.val()||$work.val())===""){formHelper.disableDate();}}});$("[data-home-number]").on("blur",function(){if($(this).val()!=""){formHelper.enableDate();if(formHelper.isHomeNumberValid($(this).val())){formHelper.clearError($(this));}else{formHelper.setError($(this),"<p>Enter a valid Australian or Norfolk Island landline phone number. Australian landline numbers contain 10 digits and begin with 02, 03, 07 or 08</p>");}}else{formHelper.clearError($(this));if(($work.val()||$mobile.val())===""){formHelper.disableDate();}}});$("[data-work-number]").on("blur",function(){if($(this).val()!=""){formHelper.enableDate();if(formHelper.isWorkNumberValid($(this).val())){formHelper.clearError($(this));}else{formHelper.setError($(this),"<p>Enter a valid Australian or Norfolk Island phone number. Australian phone numbers contain 10 digits and begin with 02, 03, 07, 08 or 04 for mobile numbers</p>");}}else{formHelper.clearError($(this));if(($home.val()||$mobile.val())===""){formHelper.disableDate();}}});$("[data-home-number], [data-work-number]").on("keyup blur",function(e){if(this.value.length>0){$(this).parent().next('[type="checkbox"]').prop("disabled",false).attr("aria-disabled",false);}else{$(this).parent().next('[type="checkbox"]').prop("disabled",true).attr("aria-disabled",true);if(e.type==="blur"){$(this).parent().next('[type="checkbox"]').prop("checked",false);}}});$("[data-home-number], [data-work-number]").trigger("keyup");};contactNumber();$("[data-showmore-hideself]").on("click",function(){$(".moreUpdates[hidden]").slice(0,10).removeAttr("hidden aria-hidden");if($(".moreUpdates[hidden]").length===0){$(this).parent().hide();}});});})(jQuery);$(document).ready(function(){$("[data-email-addr]").on("blur",function(){if(formHelper.isEmailValid($(this).val())){formHelper.clearError($(this));}else{formHelper.setError($(this),"<p>Enter a valid email address. For example name@mail.com</p>");}});$("[data-number-email-input]").on("blur",function(){if((formHelper.isNotEmpty($(this).val()))&&(formHelper.chkValidCode($(this)))){formHelper.clearCodeError($(this));}else{formHelper.setCodeError($(this),"<p>Enter the 6 digit code we sent to your email address</p>");}});$("[data-number-mobile-input]").on("blur",function(){if((formHelper.isNotEmpty($(this).val()))&&(formHelper.chkValidCode($(this)))){formHelper.clearCodeError($(this));}else{formHelper.setCodeError($(this),"<p>Enter the 6 digit code we sent to your mobile number</p>");}});$("[data-number-totp--input]").on("blur",function(){if((formHelper.isNotEmpty($(this).val()))&&(formHelper.chkValidCode($(this)))){formHelper.clearCodeError($(this));}else{formHelper.setCodeError($(this),"<p>To continue, enter a code from the myGov Code Generator app</p>");}});});$("[data-mobile-num]").on("blur",function(){if(formHelper.isMobileValid($(this).val())){formHelper.clearError($(this));}else{formHelper.setError($(this),"<p>Enter a valid Australian or Norfolk Island mobile number. Australian mobile numbers contain 10 digits and begin with 04.</p>");}});const securityCodesInfo=document.querySelector("#security-codes-info");if(securityCodesInfo){securityCodesInfo.setAttribute("hidden","true");}$("[data-infotext-toggle]").on("click",function(){const securityCodesInfo=document.querySelector("#security-codes-info");const hidden=securityCodesInfo.getAttribute("hidden");var attr=$(this).attr("aria-expanded");attr=attr==="false"?"true":"false";$(this).attr("aria-expanded",attr);if(hidden==null){securityCodesInfo.setAttribute("hidden","true");}else{securityCodesInfo.removeAttribute("hidden");}});$(":radio[data-inbox-pref]").on("change",function(){var selected=this.value;switch(selected){case"mobile":formHelper.clearError($("[data-email-addr]"));formHelper.resetDefaultValue($("[data-email-addr]"));$("[data-email-addr]").closest($("label")).attr({"hidden":true,"aria-hidden":true});$("[data-mobile-num]").closest($("label")).removeAttr("hidden aria-hidden");break;case"email":formHelper.clearError($("[data-mobile-num]"));formHelper.resetDefaultValue($("[data-mobile-num]"));$("[data-mobile-num]").closest($("label")).attr({"hidden":true,"aria-hidden":true});$("[data-email-addr]").closest($("label")).removeAttr("hidden aria-hidden");break;default:}});(function($){var initSQA=function(){var $form=$(".sqa-form"),$question=$("[data-secretquestion]"),$answer=$("[data-secretanswer]");$(".selectRadio input:radio").on("blur change",function(){var selectedRadioName=$(".selectRadio input:radio:checked").val();if((selectedRadioName)===undefined){formHelper.setErrorSelect($(".selectRadio"),"Make a selection");}else{formHelper.clearErrorSelect($(".selectRadio"));}});$question.on("blur",function(){var errMsg="",rule1=formHelper.chkFieldIsEmpty($(this)),rule2=chkQuestionAnswerSame(),rule3=formHelper.chkTooManyCharacters($(this),100);if(rule1){errMsg="Enter a question";}else{if(rule2){errMsg="The question and answer must be different";}else{if(rule3){errMsg="The question can't be more than 100 characters including spaces";}}}if(errMsg!==""){formHelper.setError($(this),"<p>"+errMsg+"</p>");}else{formHelper.clearError($question);}chkQuestionAnswerSame();});$answer.on("blur",function(){var errMsg="",rule1=formHelper.chkFieldIsEmpty($(this)),rule2=chkQuestionAnswerSame(),rule3=formHelper.chkTooManyCharacters($(this),40);if(rule1){errMsg="Enter an answer";}else{if(rule2){errMsg="The question and answer must be different";}else{if(rule3){errMsg="The answer can't be more than 40 characters including spaces";}}}if(errMsg!==""){formHelper.setError($(this),"<p>"+errMsg+"</p>");}else{formHelper.clearError($answer);}});$question.on("keyup",function(){var errMsg="",rule1=formHelper.chkTooManyCharacters($(this),100);if(rule1){errMsg="The question can't be more than 100 characters, including spaces";}if(errMsg!==""){formHelper.setError($(this),"<p>"+errMsg+"</p>");}});$answer.on("keyup",function(){var errMsg="",rule1=formHelper.chkTooManyCharacters($(this),40);if(rule1){errMsg="The answer can't be more than 40 characters including spaces";}if(errMsg!==""){formHelper.setError($(this),"<p>"+errMsg+"</p>");}});var chkQuestionAnswerSame=function(){var errMsg="The question and answer must be different";$questionValue=$question.length>0?$question.val().trim().toLowerCase():"";$answerValue=$answer.val().trim().toLowerCase();if(!$questionValue||!$answerValue||(!$questionValue&&!$answerValue)){return;}if($questionValue===$answerValue){return true;}else{return false;}};};var toggleOwnQuestion=function(){var $question=$("[data-secretquestion]"),$answer=$("[data-secretanswer]");$("[data-prefillquestion]").prev("input").on("change",function(){$question.val($(this).next().text());$question.parent().hide();});$("input[name=radioQuestion]").on("change",function(){var $selectedQuestion=$("input[name=radioQuestion]:checked"),$lastQuestion=$("input[name=radioQuestion]").last();if($selectedQuestion.val()!==$answer.val()){formHelper.clearError($answer);}else{formHelper.setError($answer,"<p>The question and answer must be different</p>");}if($lastQuestion.is(":checked")){formHelper.clearError($selectedQuestion);formHelper.clearError($answer);$question.val("");$question.parent().show().css("display","block");}else{formHelper.clearError($question);$question.parent().hide();}});};toggleOwnQuestion();initSQA();})(jQuery);(function($){$(document).ready(function(){if($("[data-date]").length>0){if($("[data-date]").val()!==""){var date=$("[data-date]").val().split("/");var $parent=$(".date-fields");day=$parent.find("[data-date-day]").val(date[0]);month=$parent.find("[data-date-month]").val(date[1]);year=$parent.find("[data-date-year]").val(date[2]);formHelper.enableDate();}}$("#raetDiv-home").on("change","input",function(){if($("#same-as-residential").is(":checked")){mapHomePostal();}});$("#same-as-residential").on("change",function(){if($("#same-as-residential").is(":checked")){mapHomePostal();}else{$("#postal-section input").val("");}});$("#same-as-residential").on("click",function(){$("#postal-section").toggle();});$("#raetDiv-home, #raetDiv-postal").on("blur keyup","input",function(){resetDate();});var homeSectionBlank=function(){var blank=true;$("#raetDiv-home input").each(function(){if(!blank){return blank;}var input=$.trim($(this).val());blank=!input;});return blank;};var postalSectionBlank=function(){var blank=true;$("#raetDiv-postal input").each(function(){if(!blank){return blank;}var input=$.trim($(this).val());blank=!input;});return blank;};var resetDate=function(){var homeBlank=homeSectionBlank();var postalBlank=postalSectionBlank();var blank=homeBlank&&postalBlank;blank?formHelper.disableDate():formHelper.enableDate();};var mapHomePostal=function(){$("#delivery-address-line-1-singleLine").val($("#residential-address-line-1-singleLine").val());$("#postal-address").val($("#home-address").val());$("#postal-suburb").val($("#home-suburb").val());$("#postal-postcode").val($("#home-postcode").val());$("#postal-state").val($("#home-state").val());};function raetToggleText(element,name){if($("#raetDiv-"+name).attr("data-view")==="multi"){element.text("Find my "+name+" address");}if($("#raetDiv-"+name).attr("data-view")==="single"){element.text("I can't find my "+name+" address");}}function raetToggleView(name){$(".raet-"+name+"-anchor").on("click",function(){$("#raetDiv-"+name).attr("data-view",function(index,attr){return attr=="multi"?"single":"multi";});raetToggleText($(this),name);if($("#raetDiv-"+name).attr("data-view")==="multi"){raetAddress("multi",name);}if($("#raetDiv-"+name).attr("data-view")==="single"){raetAddress("single",name);}$(this).attr("aria-pressed","true").attr("aria-live","polite").attr("aria-atomic","true");$("#raetDiv-"+name).find("input")[0].focus();resetDate();});}raetToggleView("home");raetToggleView("postal");function removeContainers(root){if(root){$("> .raet-container",$(root)).remove();}}function raetAddress(view,name){var rootContainer=$("#raetDiv-"+name);if(rootContainer){removeContainers(rootContainer);var config={webService:"prod_secure",destination:document.getElementById("raetDiv-"+name),fields:{streetAddress:document.getElementById(name+"-address"),suburb:document.getElementById(name+"-suburb"),postcode:document.getElementById(name+"-postcode"),state:document.getElementById(name+"-state")},labels:{singleLine:"Find address"}};if(view==="single"){config.type="singleLine";}if(view==="multi"){config.integration=true;}Raet(config);}}function raetInit(name){$("#"+name+"-output").each(function(){var allEmpty=true;$(this).find('input[type="text"]').each(function(){if(this.value.trim().length>0){allEmpty=false;$("#raetDiv-"+name).attr("data-view","multi");raetAddress("multi",name);raetToggleText($(".raet-"+name+"-anchor"),name);return false;}});if(allEmpty===true){$("#raetDiv-"+name).attr("data-view","single");raetAddress("single",name);raetToggleText($(".raet-"+name+"-anchor"),name);}});}raetInit("home");raetInit("postal");});})(jQuery);$(document).ready(function(){$("[data-identity-expanded]").on("click",function(){$(this).attr("aria-expanded",function(name,value){return value==="false"?"true":"false";});$(".identity-hub-info-text").slideToggle();clearArrows();if($(this).attr("aria-expanded")==="true"){$("#find-out-more-digital-identity").removeClass("link-arrow-down");$("#find-out-more-digital-identity").addClass("link-arrow-up");}else{$("#find-out-more-digital-identity").removeClass("link-arrow-up");$("#find-out-more-digital-identity").addClass("link-arrow-down");}});function clearArrows(){$("#find-out-more-digital-identity").removeClass("link-arrow-down");$("#find-out-more-digital-identity").removeClass("link-arrow-up");}$("[data-login-username]").on("blur",function(){if($(this).val().trim()!==""){var message="<p>Enter a valid email address, mobile number or myGov username. A valid myGov username is 2 letters, followed by 6 numbers.</p>";if(formHelper.isEmailValid($(this).val())||(/^[A-z]{2}[0-9]{6}$/g).test($(this).val())||formHelper.isMobileValid($(this).val())){formHelper.clearError($(this));}else{formHelper.setError($(this),message);}}else{formHelper.setError($(this),"<p>Enter a username or email address</p>");}});$("#mygov-beta").on("click",function(e){var action=dynaTrace.enterAction("myGovBetaNav","click");dynaTrace.leaveAction(action);});});window.addEventListener("hashchange",function(event){var element=document.getElementById(location.hash.substring(1));if(element){if(!/^(?:a|select|input|button|textarea)$/i.test(element.tagName)){element.tabIndex=-1;}element.focus();}},false);$("[data-poro-input]").on("blur",function(){if($(this).val()!==""){if($('input[name="formId"]').val()==="clkPersonalDetailsFast"){}else{var pattern=new RegExp($(this).attr("data-pattern"));var validPattern=pattern.test($(this).val());if(!validPattern){var patternMsg=$(this).attr("data-pattern-msg");var msg="<p>Enter a valid value</p>";msg=patternMsg!==undefined?patternMsg:msg;formHelper.setError($(this),msg);}else{formHelper.clearError($(this));}}}});$("[data-poro-input-mandatory]").on("blur",function(){if($('input[name="formId"]').val()==="clkPersonalDetailsFast"){}else{if(formHelper.isNotEmpty($(this).val())){if($(this).attr("data-poro-input")===undefined){formHelper.clearError($(this));}}else{formHelper.setError($(this),"<p>Require a value</p>");}}});$("[data-poro-checkbox-mandatory]").on("blur",function(){if($(this).is(":checked")){formHelper.clearError($(this));}else{formHelper.setError($(this),"<p>Must be selected</p>");}});$("[data-helptext-toggle]").on("click",function(){var attr=$(this).attr("aria-expanded");attr=attr==="false"?"true":"false";$(this).attr("aria-expanded",attr);$(this).attr("tabindex",tabindex);var $ariaControl=$("#"+$(this).attr("aria-controls"));var tabindex=$ariaControl.attr("tabindex");tabindex=tabindex==="-1"?"0":"-1";$ariaControl.attr("tabindex",tabindex);$ariaControl.toggle();});$("[button-poro-cancel]").on("click",function(e){e.preventDefault();});$("[data-helptext-toggle]").on("keypress",function(e){if(e.which===32){$(this).trigger("click");}if(e.which===9){e.preventDefault();}});$("[data-number--only]").on("blur",function(e){if(formHelper.isNotEmpty($(this).val())&&formHelper.chkNumberOnly($(this))){formHelper.clearError($(this));}else{formHelper.setError($(this),"<p>Enter a valid number</p>");}});$("[data-number--optional]").on("blur",function(e){if(formHelper.chkNumberOnly($(this))){formHelper.clearError($(this));}else{if(formHelper.isNotEmpty($(this).val())){formHelper.setError($(this),"<p>Enter a valid number</p>");}}});$("[data-medicare--input]").on("blur",function(e){if(formHelper.chkNumberOnly($(this))&&$(this).val().length===10){formHelper.clearError($(this));}else{formHelper.setError($(this),"<p>Enter a valid medicare number</p>");}});$(document).ready(function(){if($('input[name="formId"]').val()==="clkPersonalDetailsFast"){$("input[name*=clkCRN]").addClass("is-visuallyhidden").val("000000000Z");$("button[name=_eventId_next]").text("Continue");}var keyup_checker=function(evt){var stroke,_ref;stroke=(_ref=evt.which)!=null?_ref:evt.keyCode;this.search_field_scale();switch(stroke){case 8:if(this.is_multiple&&this.backstroke_length<1&&this.choices_count()>0){return this.keydown_backstroke();}else{if(!this.pending_backstroke){this.result_clear_highlight();return this.results_search();}}break;case 13:evt.preventDefault();evt.stopPropagation();if(this.results_showing){return this.result_select(evt);}else{this.results_search();}break;case 27:if(this.results_showing){this.results_hide();}return true;case 9:case 38:case 40:case 16:case 91:case 17:case 18:break;default:return this.results_search();}};$(".chosen-select-man, .chosen-select").each(function(i,select){var $select=$(select);var container=$select.chosen($select.hasClass(".chosen-select")?{allow_single_deselect:true}:{});var data=container.data("chosen");if(data){data.keyup_checker=keyup_checker;data.container.on("keydown",function(e){if(e.key==="Enter"||e.keyCode===13){e.preventDefault();e.stopPropagation();}});var showing=false;data.container.focusin(function(e){if(!showing){data.dropdown.css({left:"0",bottom:"0",overflow:"hidden","z-index":"0"});}});$select.on("chosen:showing_dropdown",function(){showing=true;data.dropdown.css({left:"",bottom:"",overflow:"","z-index":"1"});});$select.on("chosen:hiding_dropdown",function(){showing=false;data.dropdown.css({left:"0",bottom:"0",overflow:"hidden","z-index":"0"});});}});});$(document).ready(function(){var uPIN={init:function(){uPIN.cacheDom();uPIN.onBlur(uPIN.$newPin);uPIN.onBlur(uPIN.$reenterPin);uPIN.onKeyup(uPIN.$newPin);uPIN.onKeyup(uPIN.$reenterPin);$(uPIN.$currentPin).on("blur",function(){console.log(uPIN.$currentPin);if(!uPIN.isEmpty(this)){return;}});$(uPIN.$newPin).on("blur",function(){if(uPIN.$reenterPin.val()!=""){uPIN.$reenterPin.trigger("keyup");}});uPIN.$Pin=$("[data-pin]");$(uPIN.$currentPin).on("blur",function(){if(!uPIN.isEmpty(this)){return;}});},cacheDom:function(){uPIN.$currentPin=$("[data-current-pin]");uPIN.$newPin=$("[data-new-pin]");uPIN.$reenterPin=$("[data-reenter-pin]");},isEmpty:function(element){if(formHelper.isEmpty(element.value)){formHelper.setError($(element),"<p>Enter a PIN</p>");return false;}else{formHelper.clearError($(element));return true;}},onBlur:function(element){$(element).on("blur",function(){uPIN.validate(this);});},onKeyup:function(element){$(element).on("keyup",function(e){if(e.which===9){return;}if(e.which===16){return;}uPIN.match(this);});},match:function(element){var successMsg,errorMsg,isSame;if(element.attributes.hasOwnProperty("data-reenter-pin")){isSame=formHelper.isTypingSame(uPIN.$reenterPin,uPIN.$newPin);}if(isSame!==undefined){if(isSame){successMsg="Your PINs are the same";errorMsg="";}else{errorMsg="<p>The PIN you've re-entered doesn't match your new PIN</p>";successMsg="";}if(formHelper.isNotEmpty(uPIN.$reenterPin.val())){(errorMsg!=="")?formHelper.setError(uPIN.$reenterPin,errorMsg):formHelper.setSuccess(uPIN.$reenterPin,successMsg);}}},maxChars:function(element){if(element.value.length!==4){formHelper.setError($(element),"<p>Your PIN must contain 4 numbers</p>");return false;}else{formHelper.clearError($(element));return true;}},notAscending:function(element){if(element.value.length===4&&"0123456789".indexOf(element.value)!=-1){formHelper.setError($(element),"<p>Your PIN can't contain 4 consecutive numbers</p>");return false;}else{formHelper.clearError($(element));return true;}},notDescending:function(element){if(element.value.length===4&&"9876543210".indexOf(element.value)!=-1){formHelper.setError($(element),"<p>Your PIN can't contain 4 consecutive numbers</p>");return false;}else{formHelper.clearError($(element));return true;}},numericOnly:function(element){if(!(/^\d*$/g).test(element.value)){formHelper.setError($(element),"<p>Your PIN must contain 4 numbers</p>");return false;}else{formHelper.clearError($(element));return true;}},sameDigits:function(element){if((/^([0-9])\1{3}$/g).test(element.value)){formHelper.setError($(element),"<p>Your PIN can't contain 4 of the same number</p>");return false;}else{formHelper.clearError($(element));return true;}},validate:function(element){if(!uPIN.isEmpty(element)){return;}if(!uPIN.maxChars(element)){return;}if(!uPIN.numericOnly(element)){return;}if(!uPIN.sameDigits(element)){return;}if(!uPIN.notAscending(element)){return;}if(!uPIN.notDescending(element)){return;}if(!uPIN.match(element)){return;}}};uPIN.init();});$(document).ready(function(){var usernameField=$("[data-username]");function validateUsername($inputField){var unameval=$inputField.val(),unameMatch=unameval?formHelper.isUserIdValid(unameval):false,emailMatch=unameval?formHelper.isEmailValid(unameval):false,mobileMatch=unameval?formHelper.isMobileValid(unameval):false;if(unameMatch||emailMatch||mobileMatch){formHelper.clearError($inputField);if(mobileMatch){formHelper.setInfo($inputField,'You must have this <a href="/mygov/content/html/help.html#MobileNumber">mobile number</a> set up as a username in your Account settings.');}else{formHelper.clearInfo($inputField);}}else{formHelper.clearInfo($inputField);formHelper.setError($inputField,"<p>Enter a valid email address, mobile number or myGov username. A valid myGov username is 2 letters, followed by 6 numbers.</p>");}}usernameField.on("focusout",function(){if(!this.hasAttribute("dont-validate")){validateUsername($(this));}});});$(document).ready(function(){var usernameEmailField=$("[data-username-email]");function validateUsernameEmail($inputField){var unameval=$inputField.val(),emailMatch=unameval?formHelper.isEmailValid(unameval):false;if(emailMatch){formHelper.clearError($inputField);}else{formHelper.clearInfo($inputField);formHelper.setError($inputField,"<p>Enter a valid email</p>");}}usernameEmailField.on("blur",function(){if(!this.hasAttribute("dont-validate")){validateUsernameEmail($(this));}});});(function($){$(":radio[data-apdm]").on("change",function(){var selected=this.value;switch(selected){case"true":$(".button-main").replaceWith('<button type="submit" class="button-main button">Next</button>');break;case"false":$(".button-main").replaceWith('<a href="'+$("#apdmLink").val()+'" role="button" class="button-main button">Next</a>');break;default:}});})(jQuery);(function($){$(window).on("resize",function(){var $expand=$(".outage .expand");if($expand.length&&!$expand.hasClass("expand--expanded")){var content=$(".outage__content").get(0);if(content&&content.offsetWidth>=content.scrollWidth){$expand.attr({"hidden":true,"aria-hidden":true});}else{if($expand.attr("hidden")){$expand.removeAttr("hidden aria-hidden");}}}}).resize();$(".outage").on("click",".expand",function(){$(this).toggleClass("expand--expanded").next(".outage__content").toggleClass("outage__content--expanded");});$("[data-dismiss]").each(function(){$(this).append('<button class="dismiss"><span class="is-visuallyhidden">Dismiss</span></button>');});$("[data-dismiss]").on("click",".dismiss",function(e){e.preventDefault();$(this).parent().fadeOut("fast",function(){$(this).remove();});});$("[data-dismiss-otp-alert]").on("click",".dismiss",function(){$.getJSON("/mygov/dismiss/sio");});$("[data-dismiss-inbox-alert]").on("click",".dismiss",function(){$.getJSON("/mygov/dismiss-inbox-alert");});$("[data-banner-digiId]").on("click",".data-banner-dismiss-button",function(e){e.preventDefault();$("[data-banner-digiId]").fadeOut("fast",function(){$(this).remove();});$.getJSON("/mygov/dismiss/digiId");});$("[data-alert-digiId]").on("click",".data-alert-dismiss-button",function(e){e.preventDefault();$("[data-alert-digiId]").fadeOut("fast",function(){$(this).remove();});$.getJSON("/mygov/dismiss/digiId");});})(jQuery);(function($){$(document).ready(function(){function wait(seconds,formId){setTimeout(function(){submitForm(formId);},seconds*1000);}function submitForm(formId){try{document.getElementById(formId).submit();}catch(err){}}wait(10,"oidcRedirForm");wait(2,"redirForm");});})(jQuery);$("[data-home-welcome-message]").each(function(){$(this).text("Good "+getGreetingTime(moment())+" ");});function getGreetingTime(m){var g=null;if(!m||!m.isValid()){return;}var split_afternoon=12;var split_evening=17;var currentHour=parseFloat(m.format("HH"));if(currentHour>=split_afternoon&&currentHour<=split_evening){g="afternoon";}else{if(currentHour>=split_evening){g="evening";}else{g="morning";}}return g;}$(function(){var upins=$("#upin-login, #upin-input, #upin-confirm");if(global.getAndroidVersion()<4.3){$("fieldset.pin-fields, div.pin-fields").removeClass("pin-fields");upins.attr({type:"password",pattern:"[0-9]*",inputmode:"numeric"}).val("").focus();}else{upins.val("").pincodeInput({hidedigits:true,inputs:4});var upinData=upins.data("plugin_pincodeInput");if(upinData){}}if(global.getUrlParams().event==="close"){$("a.button-back-home").text("Close").removeClass("button-back").click(function(e){e.preventDefault();window.close();});}});var initPinToggle=function(){$(".showPin").on("click",function(){var $this=$(this),$inputType,$passwordInput=$this.siblings("input"),relatedInputStr="",$pinInput=$("#pincode-input");$inputType=$passwordInput.attr("type");if($pinInput.hasClass("conceal")){setPinHide($this);}else{setPinShow($this);}});};var setPinShow=function($this){var $pinInput=$("#pincode-input");$showpinhelptext="Note: this will visually expose your pin on the screen.";$showhelp=$("#show-hide-helpmsg");$pinInput.removeClass("reveal");$pinInput.addClass("conceal");$this.attr("aria-label","Show pin as plain text.").attr("aria-describedby","show-hide-helpmsg").html("<img id='show-hide-icon' src='/mygov/content/mgv2//icons/feather-eye.svg' alt='' /> Show");$showhelp.replaceWith("<p class='is-visuallyhidden' id='show-hide-helpmsg'>"+$showpinhelptext+"</p>");};var setPinHide=function($this){var $pinInput=$("#pincode-input");$pinInput.removeClass("conceal");$pinInput.addClass("reveal");var $hidepinhelptext="Note: this will visually stop exposing your pin on the screen.";$hidehelp=$("#show-hide-helpmsg");$this.attr("aria-label","Hide pin").attr("aria-describedby","show-hide-helpmsg").html("<img id='show-hide-icon' src='/mygov/content/mgv2//icons/feather-eye-off.svg' alt=''  /> Hide");$hidehelp.replaceWith("<p class='is-visuallyhidden' id='show-hide-helpmsg'>"+$hidepinhelptext+"</p>");};$("body").on("click keydown","[data-idp-help-toggle]",function(e){var codes={ENTER:13};if(e.type==="click"||e.keyCode===codes.ENTER){var attr=$(this).attr("aria-expanded");attr=attr==="false"?"true":"false";$(this).attr("aria-expanded",attr);$(this).attr("tabindex",tabindex);var $ariaControl=$("#"+$(this).attr("aria-controls"));var tabindex=$ariaControl.attr("tabindex");$ariaControl.attr("tabindex",tabindex);if($ariaControl.css("display")==="flex"){$ariaControl.css("display","none");}else{$ariaControl.css("display","flex");}}});$(function(){var additionalSelectors="";var fields=$("[autofocus]");if(additionalSelectors){fields.add(additionalSelectors);}var focusField=fields[0];if(focusField){focusField.setAttribute("dont-validate","");global.oneUseEvent(focusField,"keyup",function(){focusField.removeAttribute("dont-validate");});}});var va_isMaximised=false;var va_isOpen=false;var va_isMobile=false;var va_pushTimeout;var va_chatStarted=false;var titleBarTitle="Ask a question";var headingTitle="Ask a question";function getMobileHeader(){var mobileLargeClass="",vaOpenClass="";if(va_isOpen){mobileLargeClass=' class="va_mobileLarge" ';vaOpenClass=" va_open";}var mobileStyle='<div id="va_mobileBar" style="border-top: #d7ea6a 5px solid"'+mobileLargeClass+' aria-live="polite" >'+'<header class="va_header">'+'<h2 class="va_chatTitle_mob" aria-live="polite" id="va_chatTitle">'+headingTitle+"</h2>"+'<div role="button" style="border: 0; margin: 0;" id="va_mobileToggle" aria-live="polite" class="va_mobileToggle'+vaOpenClass+'" title="'+getAltText("va_toggleIcon")+'" aria-label="'+getAltText("va_mobileToggle")+'"></div>'+"</header>"+"</div>";return mobileStyle;}function getDesktopHeader(){var rightMargin=calcRightMargin(),desktopHeaderSize="style='right:"+rightMargin+"'",vaExpanded="",resizeIconState="",resizeIconClass="";if(va_isOpen){vaExpanded=" va_expanded";resizeIconState='style="display: block;"';if(va_isMaximised){desktopHeaderSize='style="height:490px; width:600px; right:'+rightMargin+';"';resizeIconClass=" va_large";}else{desktopHeaderSize='style="height:455px; width:350px; right:'+rightMargin+';"';}}var desktopStyle='<div id="va_chatHeader" '+desktopHeaderSize+' aria-live="polite" title="'+titleBarTitle+'" aria-label="'+titleBarTitle+'">'+'<div class="va_chatBorder"></div>'+'<header class="va_header va_clearfix" style="box-shadow:0 0 3px rgba(0,0,0,.3)">'+'<h2 class="va_chatTitle" id="va_chatTitle" aria-live="polite" >'+headingTitle+"</h2>"+'<div id="va_resizeIcon" class="va_resizeIcon'+resizeIconClass+'" '+resizeIconState+' tabindex="0" aria-live="polite" title="'+getAltText("va_resizeIcon")+'" aria-label="'+getAltText("va_resizeIcon")+'" style="display: none"></div>'+'<div id="va_toggleIcon" class="va_toggleIcon'+vaExpanded+'" tabindex="0" aria-live="polite" title="'+getAltText("va_toggleIcon")+'" aria-label="'+getAltText("va_toggleIcon")+'"></div>'+"</header>"+"</div>";return desktopStyle;}function getAltText(element){if(element=="va_toggleIcon"||element=="va_mobileToggle"){if(va_isOpen){return"Hide "+titleBarTitle;}else{return"Open "+titleBarTitle;}}else{if(element=="va_resizeIcon"){if(va_isMaximised){return"View "+titleBarTitle+" in a smaller window";}else{return"View "+titleBarTitle+" in a larger window";}}}}function setAltText(element){var resizeAlt=getAltText(element);jQuery("#"+element).prop("title",resizeAlt);jQuery("#"+element).attr("aria-label",resizeAlt);}function calcRightMargin(){var windowWidth=jQuery(window).width(),maxContainerWidth=960,rightMargin="2%";return rightMargin;}function insertDiv(){var rightMargin=calcRightMargin(),chatAnchor=document.createElement("div"),appendStyle=va_isMobile==true?getMobileHeader():getDesktopHeader();chatAnchor.id="va_chatAnchor";chatAnchor.className="va_chatAnchor";chatAnchor.zIndex=99999;chatAnchor.setAttribute("role","complementary");chatAnchor.setAttribute("aria-labelledBy","va_chatTitle");document.body.appendChild(chatAnchor);jQuery("#va_chatAnchor").append(appendStyle);}function insertIframe(){var iframe=document.createElement("iframe");iframe.id=iframe.name="va_iframe";iframe.className="va_iframe";iframe.style.zIndex=9999;iframe.style.background="#E5E5E5";iframe.style.right=calcRightMargin();iframe.style.overflow="hidden";jQuery("#va_chatAnchor").append(iframe);}function determineContext(){return"";}function insertIframeSrc(){va_chatStarted=true;var context=determineContext();var source=setDAsource();setIFrameSrc(source);}function setIFrameSrc(source){if(typeof source!="undefined"&&source!=""){jQuery.when(jQuery("#va_iframe").attr("aria-live","assertive").attr("aria-relevant","additions").attr("src",source+"#/wea")).done(function(){return true;});}}function sendGoogleAnalyltics(event){try{if(ga){var context=determineContext();ga("send","event","Digital Assistant",event,context+" VA");}}catch(error){}}function addTimer(){va_pushTimeout=setTimeout(function(){sendGoogleAnalyltics("Timeout");postMessageToIframe("timeout");va_pushTimeout=null;if(!va_isMobile){jQuery("#va_chatHeader").click();}else{jQuery("#va_mobileToggle").click();}},60000);}function disableBGScrolling(){document.body.style.overflow="hidden";document.body.style.position="fixed";}function enableBGScrolling(){document.body.style.overflow="";document.body.style.position="";}function toggleVAMobile(){var toggleWidth=va_isOpen?"0px":"100%",toggleHeight=va_isOpen?"0px":(jQuery(window).height()-50);jQuery("#va_iframe").css({width:toggleWidth,height:toggleHeight,right:"0px",top:"50px"});jQuery("#va_mobileBar").toggleClass("va_mobileLarge");jQuery("#va_mobileToggle").toggleClass("va_open");va_isOpen=!va_isOpen;setAltText("va_mobileToggle");if(va_isOpen){postMessageToIframe({"type":0,"query":{"text":[],"id":"Welcome"}});disableBGScrolling();}else{enableBGScrolling();}}function addOnClickMobile(){jQuery("#va_mobileToggle").on("click",function(){sendGoogleAnalyltics("Mobile click");if(va_pushTimeout){clearTimeout(va_pushTimeout);va_pushTimeout=null;}if(!va_chatStarted){insertIframeSrc();}toggleVAMobile();});}function isWindowMobile(){if(typeof window.matchMedia!=="undefined"){return window.matchMedia("screen and (max-width: 599px), screen and (max-height: 490px)").matches;}return jQuery(window).width()<600;}function responsiveResize(){var isNewScreenMobile=isWindowMobile();var responsiveHeight=0,responsiveWidth=0,responsiveRight="",responsiveTop="",responsiveBottom="",rightMargin=calcRightMargin();if(isNewScreenMobile){if(!va_isMobile){jQuery("#va_chatHeader").replaceWith(getMobileHeader());jQuery("#va_iframe").css("display","");addOnClickMobile();}if(va_isOpen){disableBGScrolling();responsiveHeight=jQuery(window).height()-50;responsiveWidth=jQuery(window).width();responsiveRight="0px";responsiveTop="50px";}}else{enableBGScrolling();if(va_isMobile){jQuery("#va_mobileBar").replaceWith(getDesktopHeader());addOnClickDesktop();addOnResize();}else{jQuery("#va_chatHeader").css({right:rightMargin});}if(va_isOpen){responsiveBottom="0px";if(va_isMaximised){responsiveHeight=435;responsiveWidth=600;}else{responsiveHeight=400;responsiveWidth=350;}}responsiveRight=rightMargin;}jQuery("#va_iframe").css({height:responsiveHeight,width:responsiveWidth,right:responsiveRight,top:responsiveTop,bottom:responsiveBottom});va_isMobile=isNewScreenMobile;}function toggleVADesktop(){var ariaHidden=va_isOpen?"true":"false";if(va_isMaximised){var toggleHeight=va_isOpen?"0px":"435px",toggleWidth=va_isOpen?"0px":"600px",headerHeight=va_isOpen?"55px":"490px",headerWidth=va_isOpen?"350px":"600px";}else{var toggleHeight=va_isOpen?"0px":"400px",toggleWidth=va_isOpen?"0px":"350px",headerHeight=va_isOpen?"55px":"455px",headerWidth="350px";}if(!va_isOpen){if(va_isMaximised){jQuery("#va_iframe").animate({height:toggleHeight,width:toggleWidth});if(!jQuery("#va_resizeIcon").hasClass("va_large")){jQuery("#va_resizeIcon").addClass("va_large");}}else{jQuery("#va_iframe").animate({height:toggleHeight});jQuery("#va_iframe").css({width:toggleWidth});}jQuery("#va_iframe").css("display","inline-block");postMessageToIframe({"type":0,"query":{"text":[],"id":"Welcome"}});}else{jQuery("#va_iframe").animate({height:toggleHeight,width:"350px"});setTimeout(function(){jQuery("#va_iframe").css({width:toggleWidth,display:"none"});},500);}jQuery("#va_chatHeader").animate({height:headerHeight,width:headerWidth},{duration:400,queue:false});jQuery(".va_chatBorder").animate({width:headerWidth},{duration:400,queue:false});jQuery("#va_resizeIcon").toggle();jQuery("#va_toggleIcon").toggleClass("va_expanded");jQuery("#va_skipToConversation").toggleClass("active");jQuery("#va_skipToConversation").attr("aria-hidden",ariaHidden);postMessageToIframe("setAriaHiddenTags"+ariaHidden);va_isOpen=!va_isOpen;setAltText("va_toggleIcon");return true;}function addOnClickDesktop(){jQuery("#va_chatHeader").on("click",function(e){sendGoogleAnalyltics("Desktop click");if(va_pushTimeout){clearTimeout(va_pushTimeout);va_pushTimeout=null;}if(!va_chatStarted){insertIframeSrc();}toggleVADesktop();return false;});jQuery("#va_toggleIcon").bind("keyup",function(e){if(e.keyCode===13){jQuery("#va_chatHeader").click();}});}function addOnResize(){jQuery("#va_resizeIcon").on("click",function(e){resizeVA();e.stopPropagation();return false;});jQuery("#va_resizeIcon").bind("keyup",function(e){if(e.keyCode===13){jQuery("#va_resizeIcon").click();e.stopPropagation();}});}function resizeVA(){var resizeWidth=va_isMaximised?"350px":"600px",resizeHeight=va_isMaximised?"400px":"435px",resizeHeaderHeight=va_isMaximised?"455px":"490px",resizeHeaderWidth=va_isMaximised?"350px":"600px";jQuery("#va_chatHeader").animate({width:resizeHeaderWidth,height:resizeHeaderHeight},{duration:400,queue:false});jQuery(".va_chatBorder").animate({width:resizeHeaderWidth},{duration:400,queue:false});jQuery("#va_iframe").animate({height:resizeHeight,width:resizeWidth},{duration:400,queue:false});jQuery("#va_resizeIcon").toggleClass("va_large");va_isMaximised=!va_isMaximised;setAltText("va_resizeIcon");}function addOnBackwardsTabbing(){jQuery("#va_skipToConversation").unbind("keydown");jQuery("#va_skipToConversation").bind("keydown",function(e){if(e.shiftKey&&e.keyCode===9){postMessageToIframe("loopFocusBackward");e.preventDefault();}else{if(e.keyCode===13){postMessageToIframe("skiptoConversation");e.stopPropagation();}}});}function loopFocusBackwardWithError(){jQuery("#va_resizeIcon").bind("keydown",function(e){if(e.shiftKey&&e.keyCode===9){postMessageToIframe("loopFocusBackwardWithError");e.preventDefault();}});}function addSkipToConversationTabListener(){jQuery("#va_skipToConversation").unbind("keydown");jQuery("#va_skipToConversation").bind("keydown",function(e){if(e.shiftKey&&e.keyCode===9){postMessageToIframe("loopFocusBackwardOptionButton");e.stopPropagation();}else{if(e.keyCode===13){postMessageToIframe("skiptoConversation");e.stopPropagation();}}});}function addOnSkipToConversation(){jQuery("#va_skipToConversation").on("click",function(e){postMessageToIframe("skiptoConversation");e.stopPropagation();return false;});addOnBackwardsTabbing();}function addSkipToBot(){var skipLinks=jQuery(".skip-links");var skipLinkClass="";if(skipLinks.length==0){skipLinks=jQuery(".uikit-skip-link");skipLinkClass='class="uikit-skip-link__link"';}skipLinks.append("<a "+skipLinkClass+' id="va_skipToBot" href="#">Skip to '+titleBarTitle+"</a>");jQuery("#va_skipToBot").on("click",function(e){if(!va_isMobile){jQuery("#va_toggleIcon").focus();}else{jQuery("#va_mobileToggle").click();}e.stopPropagation();return false;});}function hideSkipToConversation(){jQuery("#va_skipToConversation").hide();jQuery("#va_skipToConversation").attr("aria-hidden","true");}function skipToSkipToConversation(){jQuery("#va_skipToConversation").focus();}function skipToResizeIcon(){jQuery("#va_resizeIcon").focus();}function postMessageToIframe(message){window.parent.document.getElementById("va_iframe").contentWindow.postMessage(message,"*");}function addListenerForIframe(){window.addEventListener("message",function(e){if(e.data&&e.data.type=="error"){e.stopPropagation();jQuery("#va_chatAnchor").hide();}else{if(e.data&&e.data.type=="interaction"){e.stopPropagation();recordBotInteraction(new Date());}else{if(e.data&&e.data.type=="ready"){e.stopPropagation();if(va_isOpen){postMessageToIframe({"type":0,"query":{"text":[],"id":"Welcome"}});}jQuery("#va_chatAnchor").show();}else{if(e.data&&e.data.type=="reload"){e.stopPropagation();if(va_isOpen){if(va_isMobile){toggleVAMobile();}else{toggleVADesktop();}}}else{if(e.data=="loopFocusForward"){skipToSkipToConversation();e.stopPropagation();}else{if(e.data=="loopFocusForwardError"){setTimeout(function(){skipToResizeIcon();},100);e.stopPropagation();}else{if(e.data=="addOnBackwardsTabbing"){addOnBackwardsTabbing();}else{if(e.data=="loopFocusForwardOptionButton"){skipToSkipToConversation();addSkipToConversationTabListener();}else{if(e.data=="errorDisplayed"){hideSkipToConversation();loopFocusBackwardWithError();}else{if(e.data=="textboxFocus"){setTimeout(function(){scrollPageToBottom();},100);}}}}}}}}}}});}function addDigitalAssistant(){va_isMobile=isWindowMobile();insertDiv();insertIframe();insertIframeSrc();addOnResize();addSkipToBot();addOnSkipToConversation();addListenerForIframe();addOnClickDesktop();addOnClickMobile();window.addEventListener("resize",responsiveResize);}function scrollPageToBottom(){window.scrollTo(0,document.body.scrollHeight);}function isIE(){var myNav=navigator.userAgent.toLowerCase();return(myNav.indexOf("msie")!=-1)?parseInt(myNav.split("msie")[1]):false;}function newShowIdentityModal(){const modalBackground=document.getElementById("digital-id-modal-background");modalBackground.classList.remove("new-hide");modalBackground.classList.add("new-fade");modalBackground.classList.add("new-show");const modalContent=document.getElementById("new-modal-content");modalContent.setAttribute("open","true");modalContent.classList.remove("new-hide");modalContent.classList.add("new-slide-in");modalContent.setAttribute("aria-modal","true");modalContent.setAttribute("aria-expanded","true");modalContent.setAttribute("aria-hidden","false");document.getElementById("first-dismiss").focus();document.getElementById("identity-display-form").addEventListener("submit",ignoreSubmit);document.getElementById("digital-id-modal-background").addEventListener("click",newHideIdentityModal);document.addEventListener("keydown",handleKeyboardInput);if(window.dynaTrace){var action=window.dynaTrace.enterAction("showIdentityModal","click");window.dynaTrace.leaveAction(action);}}function ignoreSubmit(event){event.preventDefault();return false;}function handleKeyboardInput(trigger){if(trigger.code){switch(trigger.code){case"Escape":keyboardDismiss();break;case"Tab":const primaryModal=document.getElementById("new-modal-content");const secondaryModal=document.getElementById("secondary-identity-modal");if(primaryModal&&primaryModal.getAttribute("open")==="true"){trapFocusPrimary(trigger);}if(secondaryModal&&secondaryModal.getAttribute("open")==="true"){trapFocusSecondary(trigger);}break;case"Enter":if(document.activeElement===document.getElementById("decline-digital-identity")){trigger.preventDefault();document.getElementById("decline-digital-identity").checked=true;}if(document.activeElement===document.getElementById("confirm-digital-identity")){trigger.preventDefault();document.getElementById("confirm-digital-identity").checked=true;}document.getElementById("identity-first-confirm-button").disabled=false;break;}}}function trapFocusPrimary(event){var focusableElements=[document.getElementById("first-dismiss"),document.getElementById("decline-digital-identity"),document.getElementById("confirm-digital-identity"),document.getElementById("identity-first-confirm-button")];var firstFocused=focusableElements[0];var lastFocused=focusableElements[3];if(lastFocused.disabled){lastFocused=focusableElements[1];}if(event.shiftKey&&event.keyCode===9){if(document.activeElement===firstFocused){lastFocused.focus();event.preventDefault();}}else{if(document.activeElement===lastFocused){firstFocused.focus();event.preventDefault();}}}function removeSelection(){document.getElementById("confirm-digital-identity").checked=false;document.getElementById("decline-digital-identity").checked=false;document.getElementById("identity-first-confirm-button").disabled=true;}function trapFocusSecondary(event){var focusableElements=[document.getElementById("second-dismiss"),document.getElementById("return-to-mygov-link"),document.getElementById("identity-second-confirm-button")];var first=focusableElements[0];var last=focusableElements[2];if(event.shiftKey&&event.keyCode===9){if(document.activeElement===first){last.focus();event.preventDefault();}else{if(document.activeElement===focusableElements[1]){first.focus();event.preventDefault();}}}else{if(document.activeElement===last){first.focus();event.preventDefault();}}}function keyboardDismiss(){const primaryModal=document.getElementById("new-modal-content");const secondaryModal=document.getElementById("secondary-identity-modal");if(primaryModal&&primaryModal.getAttribute("open")==="true"){newHideIdentityModal();}if(secondaryModal&&secondaryModal.getAttribute("open")==="true"){hideSecondaryModal();}}function enableProgressButton(){const button=document.getElementById("identity-first-confirm-button");button.disabled=false;}function summonSecondModal(){const secondaryModal=document.getElementById("secondary-identity-modal");secondaryModal.classList.remove("hidden");secondaryModal.classList.add("shown");secondaryModal.setAttribute("open","true");secondaryModal.setAttribute("aria-modal","true");secondaryModal.setAttribute("aria-expanded","true");secondaryModal.setAttribute("aria-hidden","false");document.getElementById("second-dismiss").focus();}function hideSecondaryModal(){const secondaryModal=document.getElementById("secondary-identity-modal");secondaryModal.classList.remove("shown");secondaryModal.classList.add("hidden");secondaryModal.setAttribute("open","false");secondaryModal.setAttribute("open","false");secondaryModal.setAttribute("aria-modal","false");secondaryModal.setAttribute("aria-expanded","false");secondaryModal.setAttribute("aria-hidden","true");fadeOutBackground();}function harshHideIdentityModal(){const modalContent=document.getElementById("new-modal-content");modalContent.classList.remove("new-slide-out");modalContent.classList.add("new-hide");modalContent.setAttribute("aria-modal","false");modalContent.setAttribute("aria-expanded","false");modalContent.setAttribute("aria-hidden","true");summonSecondModal();}function fadeOutBackground(){document.getElementById("digital-id-modal-background").removeEventListener("click",newHideIdentityModal);const modalBackground=document.getElementById("digital-id-modal-background");modalBackground.classList.remove("new-fade");modalBackground.classList.remove("new-show");modalBackground.classList.add("new-fade-out");removeSelection();setTimeout(function(){modalBackground.classList.remove("new-fade-out");modalBackground.classList.add("new-hide");},199);}function newHideIdentityModal(){const secondaryModal=document.getElementById("secondary-identity-modal");if(secondaryModal.classList.contains("shown")){hideSecondaryModal();}fadeOutBackground();const modalContent=document.getElementById("new-modal-content");modalContent.setAttribute("open","false");modalContent.classList.add("new-slide-out");setTimeout(function(){modalContent.classList.remove("new-slide-out");modalContent.classList.add("new-hide");modalContent.setAttribute("aria-modal","false");modalContent.setAttribute("aria-expanded","false");modalContent.setAttribute("aria-hidden","true");},999);}$("#identity-first-confirm-button").on("click",function(e){e.preventDefault();if(document.getElementById("confirm-digital-identity").checked===false){if(window.dynaTrace){var noIdentityAction=window.dynaTrace.enterAction("identityNotConnected","click");window.dynaTrace.leaveAction(noIdentityAction);}harshHideIdentityModal();return false;}else{if(window.dynaTrace){var hasIdentityAction=window.dynaTrace.enterAction("identityConnected","click");window.dynaTrace.leaveAction(hasIdentityAction);}window.location=document.getElementById("identity-first-confirm-button").getAttribute("data-kickoff-url");return false;}});var lastInteractionDate;var timeoutEventId;function getToken(isAuthenticated){var xhttp=new XMLHttpRequest();var jsontext;xhttp.onreadystatechange=function(){try{if(this.readyState==4&&this.status==200){var jsontext=JSON.parse(this.responseText);storage.save(jsontext);var source=sessionStorage.url+sessionStorage.jwt;if(typeof(Storage)!=="undefined"){if(sessionStorage.dis==="false"){source="";storage.clear();}}setIFrameSrc(source);}}catch(e){storage.clear();}};var host=window.location.hostname;var tokenUrl="/mga/sps/apiauthsvc/policy/vagt";if(isAuthenticated&&typeof(Storage)!=="undefined"){xhttp.open("POST",tokenUrl,true);xhttp.setRequestHeader("Content-Type","application/json");xhttp.setRequestHeader("Accept","application/json");var token=sessionStorage.jwt;xhttp.send(JSON.stringify({token:token}));}else{xhttp.open("GET",tokenUrl,true);xhttp.setRequestHeader("Content-Type","application/json");xhttp.setRequestHeader("Accept","application/json");xhttp.send();}return sessionStorage.jwt;}function isValidToken(token){var decodedToken=parseToken(token);if(decodedToken.exp>Date.now()/1000){return true;}return false;}function parseToken(token){var base64Url=token.split(".")[1];var base64=base64Url.replace(/-/g,"+").replace(/_/g,"/");return JSON.parse(window.atob(base64));}function checkAuthenticated(){var isAuthenticated=false;var isAuthHomepage=($("#digitalassistant-auth").length>0);var isLoginPage=($("#digitalassistant-unauth").length>0);if(isAuthHomepage||(storage.check()&&sessionStorage.aut==="true")){isAuthenticated=true;}else{if(isLoginPage){isAuthenticated=false;}}return isAuthenticated;}function setDAsource(){var isAuthenticated=false;var daSrc="";var token="";var isAuthHomepage=($("#digitalassistant-auth").length>0);var isLoginPage=($("#digitalassistant-unauth").length>0);if(isAuthHomepage){isAuthenticated=true;token=getToken(isAuthenticated);}else{if(isLoginPage){isAuthenticated=false;storage.clear();token=getToken(isAuthenticated);}else{if(storage.check()&&isValidToken(sessionStorage.jwt)){daSrc=sessionStorage.url+sessionStorage.jwt;}else{if(isAuthHomepage||(storage.check()&&sessionStorage.aut==="true")){isAuthenticated=true;}token=getToken(isAuthenticated);if(typeof token!="undefined"&&storage.check()){daSrc=sessionStorage.url+token;}}}}if(typeof(Storage)!=="undefined"){if(sessionStorage.dis==="false"){daSrc="";}}return daSrc;}function recordBotInteraction(currentInteractionDate){var timeoutValue=300000;var diff=(currentInteractionDate-lastInteractionDate);if(typeof timeoutEventId=="undefined"||typeof lastInteractionDate=="undefined"){timeoutEventId=setTimeout(function(){initiateNewConversation();},timeoutValue);}else{if(diff<timeoutValue){clearTimeout(timeoutEventId);timeoutEventId=setTimeout(function(){initiateNewConversation();},timeoutValue);}}lastInteractionDate=currentInteractionDate;}function initiateNewConversation(){var isAuthenticated=checkAuthenticated();if(!isAuthenticated){getToken(isAuthenticated);}}var storage={save:function(result){if(typeof(Storage)!=="undefined"){sessionStorage.clear();}if(typeof result!="undefined"&&typeof(Storage)!=="undefined"){sessionStorage.url=result["url"];sessionStorage.jwt=result["jwt"];sessionStorage.aut=result["authenticated"];sessionStorage.dis=result["enable"];}},clear:function(){if(typeof(Storage)!=="undefined"){sessionStorage.clear();}},check:function(){if(typeof(Storage)!=="undefined"){if(sessionStorage.jwt&&sessionStorage.url){return true;}else{return false;}}}};function isWebView(){var userAgent=window.navigator.userAgent.toLowerCase();var safari=/safari/.test(userAgent);var ios=/iphone|ipod|ipad/.test(userAgent);if(ios){if(!safari){return true;}}else{return false;}}$(document).ready(function(){if($("#digitalassistant").length>0||($("#digitalassistant-auth").length>0)){if(!isWebView()){addDigitalAssistant();}}});$(document).ready(function(){(function($){$(":radio[data-cadi-flow]").on("change",function(){var selected=this.value;switch(selected){case"digitalID":jQuery("#connectedIdButton").hide();jQuery("#digitalIdButton").show();break;case"connectedID":jQuery("#connectedIdButton").show();jQuery("#digitalIdButton").hide();break;default:}});})(jQuery);});